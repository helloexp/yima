<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>设置提成比例</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshopconfig.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wfx.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.8.2.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<style type="text/css">
.Gform .Ginput .switch.hover .newRadio-input{ float:none;}
.Gform .Ginput .Gtime2 input[type=text] { float:left; background:none;}
.Gform .Ginput .Gtime2 input[type=text]:first-child { border-radius:2px 0 0 2px;}
.Gform .Ginput .Gtime2 input[type=text]:last-child { border-radius:0 2px 2px 0;}
.Gform .Ginput .Gtime2 em { position:relative; float:left; line-height:26px; *line-height:25px; line-height:25px\9; padding:0 5px; background:#f3f3f3; border-top: solid 1px #ccc; border-bottom: solid 1px #ccc;}
.Gform .Ginput .Gtime2 em.first { border-left: solid 1px #bbb; border-radius:2px 0 0 2px;}
.Gform .Ginput .Gtime2 p{ position:relative; float:left}
.Gform .Ginput .Gtime2 p.first span.maxTips{position:absolute; top:6px; left:46px}
.Gform .Ginput .Gtime2 p.last span.maxTips{ position:absolute; top:6px; left:46px}
.plabel{line-height:28px;width:100px;text-align: right; padding-right:6px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; z-index:9999;}
</style>
</head>
<body>
<div class="popupWin">
<div class="Wcanal-tab inPop" id="Wcanal-tabon">
<div class="Wcanal-tab-list">
    <div style="float:right;">
        <a href="javascript:void(0)" title="提成如何计算" onclick="window.open('{:U('Home/Help/helpArt',array('news_id'=>'1343','type'=>11,'leftId'=>'wfx','class_name'=>'旺分销'))}')">提成如何计算?</a>
    </div>
    <div id="Wform" class="Gform">
    <form id="theform" action="{:U('Wfx/Tcgl/set_tcbl_post',array('post_ishas'=>'1'))}" method="post">
        <ul>
            <li class="Gname">设置提成比例</li>
            <li class="Ginput">
                <div class="switch" data-show="swidth2">
                    <input type="radio" value="0" name="ishas" id="ishas" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst hover" data-val="0">无提成</span>
                        <span class="vallast" data-val="1">有提成</span>
                        <input type="hidden" id="ishas_display" value="{$ishas_display|default='0'}" />
                    </div>
                </div>
            </li>
        </ul>
        <div id="swidth2" class="dn">
        <p class="font-12-cc" style="line-height:24px; padding-left:120px; color:red">按单件商品的价格比提成（%）</p>
        <ul>
            <li class="Gname">{:L('SALE_NAME_ONE')}</li>
            <li class="Ginput" style="width:600px">
                <div class="switch hover">
                    <input type="radio" name="level_1" id="level_1" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="level_1_display" value="{$level_1_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                    	<div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_1_sale" id="default_level_1_sale" type="text" class="validate[required] view-time1" value="{$default_level_1_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="default_level_1_agency" id="default_level_1_agency" type="text" class="validate[required] view-time2" value="{$default_level_1_manage|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    
                    
                    <volist name="levelOneInfo" id="vone">
                        <div <if condition="$vone['status'] eq 4">style="display:none"</if>>
                    	<p class="l plabel" style="" title="{$vone['name']}">{$vone['name']}</p>
                    	<div class="Gtime2 fn noIcon addition">
                            <input name="level_1_saleid[]" type="hidden" value="{$vone['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_1_sale[]" type="text" class="validate[required] view-time1" value="{$levelOneInfoTc[$vone['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="level_1_agency[]" type="text" class="validate[required] view-time2" value="{$levelOneInfoTc[$vone['id']]['manage_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                        </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        
        <ul <if condition="empty($levelTwoInfo)">style="display:none;"</if>>
            <li class="Gname">{:L('SALE_NAME_TWO')}</li>
            <li class="Ginput" style="width:600px">
                <div class="switch hover">
                    <input type="radio" name="level_2" id="level_2" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="level_2_display" value="{$level_2_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                    	<div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_2_sale" id="default_level_2_sale" type="text" class="validate[required] view-time1" value="{$default_level_2_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="default_level_2_agency" id="default_level_2_agency" type="text" class="validate[required] view-time2" value="{$default_level_2_manage|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    <volist name="levelTwoInfo" id="vtwo">
                        <div <if condition="$vtwo['status'] eq 4">style="display:none"</if>>
                    	<p class="l plabel" title="{$vtwo['name']}">{$vtwo['name']}</p>
                    	<div class="Gtime2 fn noIcon addition">
                        <input name="level_2_saleid[]" type="hidden" value="{$vtwo['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_2_sale[]" type="text" class="validate[required] view-time1" value="{$levelTwoInfoTc[$vtwo['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="level_2_agency[]" type="text" class="validate[required] view-time2" value="{$levelTwoInfoTc[$vtwo['id']]['manage_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                        </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        
        <ul <if condition="empty($levelThreeInfo)">style="display:none;"</if>>
            <li class="Gname">{:L('SALE_NAME_TREE')}</li>
            <li class="Ginput" style="width:600px">
                <div class="switch hover">
                    <input type="radio" name="level_3" id="level_3" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="level_3_display" value="{$level_3_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                    	<div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_3_sale" id="default_level_3_sale" type="text" class="validate[required] view-time1" value="{$default_level_3_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="default_level_3_agency" id="default_level_3_agency" type="text" class="validate[required] view-time2" value="{$default_level_3_manage|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    <volist name="levelThreeInfo" id="vthree">
                        <div <if condition="$vthree['status'] eq 4">style="display:none"</if>>
                    	<p class="l plabel" title="{$vthree['name']}">{$vthree['name']}</p>
                    	<div class="Gtime2 fn noIcon addition">
                        <input name="level_3_saleid[]" type="hidden" value="{$vthree['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_3_sale[]" type="text" class="validate[required] view-time1" value="{$levelThreeInfoTc[$vthree['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="level_3_agency[]" type="text" class="validate[required] view-time2" value="{$levelThreeInfoTc[$vthree['id']]['manage_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                        </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        <ul <if condition="empty($levelFourInfo)">style="display:none;"</if>>
            <li class="Gname">{:L('SALE_NAME_FOUR')}</li>
            <li class="Ginput" style="width:600px">
                <div class="switch hover">
                    <input type="radio" name="level_4" id="level_4" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="level_4_display" value="{$level_4_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                        <div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_4_sale" id="default_level_4_sale" type="text" class="validate[required] view-time1" value="{$default_level_4_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="default_level_4_agency" id="default_level_4_agency" type="text" class="validate[required] view-time2" value="{$default_level_4_manage|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    <volist name="levelFourInfo" id="vfour">
                    <div <if condition="$vfour['status'] eq 4">style="display:none"</if>>
                        <p class="l plabel" title="{$vfour['name']}">{$vfour['name']}</p>
                        <div class="Gtime2 fn noIcon addition">
                        <input name="level_4_saleid[]" type="hidden" value="{$vfour['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_4_sale[]" type="text" class="validate[required] view-time1" value="{$levelFourInfoTc[$vfour['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="level_4_agency[]" type="text" class="validate[required] view-time2" value="{$levelFourInfoTc[$vfour['id']]['manage_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                    </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        <ul <if condition="empty($levelFiveInfo)">style="display:none;"</if>>
            <li class="Gname">五级经销商</li>
            <li class="Ginput" style="width:600px">
                <div class="switch hover">
                    <input type="radio" name="level_5" id="level_5" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="level_5_display" value="{$level_5_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                        <div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_5_sale" id="default_level_5_sale" type="text" class="validate[required] view-time1" value="{$default_level_5_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="default_level_5_agency" id="default_level_5_agency" type="text" class="validate[required] view-time2" value="{$default_level_5_manage|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    <volist name="levelFiveInfo" id="vfive">
                    <div <if condition="$vfive['status'] eq 4">style="display:none"</if>>
                        <p class="l plabel" title="{$vfive['name']}">{$vfive['name']}</p>
                        <div class="Gtime2 fn noIcon addition">
                        <input name="level_5_saleid[]" type="hidden" value="{$vfive['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_5_sale[]" type="text" class="validate[required] view-time1" value="{$levelFiveInfoTc[$vfive['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                            <em>管理提成</em>
                            <p class="last">
                            <input name="level_5_agency[]" type="text" class="validate[required] view-time2" value="{$levelFiveInfoTc[$vfive['id']]['manage_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                    </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        <ul <if condition="empty($levelSalerInfo)">style="display:none;"</if>>
            <li class="Gname">销售员</li>
            <li class="Ginput">
                <div class="switch hover">
                    <input type="radio" name="level_saler" id="level_saler" value="1" checked="checked">
                    <div class="newRadio">
                        <span class="valfirst" data-val="0">统一设置</span>
                        <span class="vallast hover" data-val="1">分别设置</span>
                        <input type="hidden" id="saler_display" value="{$saler_display|default='0'}" />
                    </div>
                    <div class="cl"></div>
                    <div class="newRadio-default">
                    	<div class="Gtime2 fn noIcon addition mt10">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="default_level_saler" id="default_level_saler" type="text" class="validate[required] view-time1" value="{$default_saler|default='0'}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                    </div>
                    <div class="newRadio-input mt10">
                    <volist name="levelSalerInfo" id="vsaler">
                    <div <if condition="$vsaler['status'] eq 4">style="display:none"</if>>
                    	<p class="l plabel" title="{$vsaler['name']}">{$vsaler['name']}&nbsp;</p>
                    	<div class="Gtime2 fn noIcon addition">
                        <input name="level_saleid[]" type="hidden" value="{$vsaler['id']}">
                            <em class="first">销售提成</em>
                            <p class="first">
                            <input name="level_sale[]" type="text" class="validate[required] view-time1" value="{$levelSalerInfoTc[$vsaler['id']]['saler_percent']}">
                            <span class="maxTips forInput">%</span>
                            </p>
                        </div>
                        <div class="cl pb10"></div>
                    </div>
                    </volist>
                    </div>
                </div>
            </li>
        </ul>
        </div>
        <div class="DiabtnCon">
            <input type="hidden" name="m_id" id="m_id" value="{$m_id}" />
            <a class="Diabtn-all js_preview" href="javascript:void(0);">确定</a>
            <a class="Diabtn-all-del" href="javascript:void(0);" onclick="art.dialog.close()">取消</a>
            </li>
        </ul>
    </form>
    </div>
    </div>
</div>
</div>
</body>
</html>
<script type="text/javascript">
    $(document).ready(function(){
        $(".Diabtn-all").click(function(){
            var dialog;
            var parentWin = art.dialog.opener;
            if($("#ishas").val() == "1"){
                $("#theform").ajaxSubmit({
                    beforeSubmit:function(){
                        dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",fixed: true,padding:0});
                    },
                    success:function(data){
                        if(data.status == '1'){
                            dialog.time(1).content("<div class='msg-all-succeed'>"+data.info+"</div>");
                            parentWin.art.dialog.list['Tcglset'].time(1);
                            top.location.href="{:U('Wfx/Tcgl/index')}";
                            
                            return false;
                        }else{
                            dialog.time(2).content("<div class='msg-all-error'>"+data.info+"</div>");
                        }
                    },
                    dataType:'json',
                });
                return false;

            }else{
                var m_id = $("#m_id").val();
                $("#theform").attr("action","{:U('Wfx/Tcgl/set_tcbl_post')}&post_ishas=0&m_id="+m_id).ajaxSubmit({
                    beforeSubmit:function(){
                        dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",fixed: true,padding:0});
                    },
                    success:function(data){
                        if(data.status == '1'){
                            dialog.time(1).content("<div class='msg-all-succeed'>"+data.info+"</div>");
                            parentWin.art.dialog.list['Tcglset'].time(1);
                            top.location.href="{:U('Wfx/Tcgl/index')}";
                            
                            return false;
                        }else{
                            dialog.time(2).content("<div class='msg-all-error'>"+data.info+"</div>");
                        }
                    },
                    dataType:'json',
                });
                return false;
            }
            return false;
        });
        if($("#ishas_display").val() == '1'){
            $("#ishas").next().find(".vallast").click();
            if($("#level_1_display").val() == '1'){
                $("#level_1").next().find(".valfirst").click();
            }
            if($("#level_2_display").val() == '1'){
                $("#level_2").next().find(".valfirst").click();
            }
            if($("#level_3_display").val() == '1'){
                $("#level_3").next().find(".valfirst").click();
            }
            if($("#level_4_display").val() == '1'){
                $("#level_4").next().find(".valfirst").click();
            }
            if($("#level_5_display").val() == '1'){
                $("#level_5").next().find(".valfirst").click();
            }
            if($("#saler_display").val() == '1'){
                $("#level_saler").next().find(".valfirst").click();
            }
        }
        
    });

</script>