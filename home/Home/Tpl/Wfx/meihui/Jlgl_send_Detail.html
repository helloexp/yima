<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>分销管理_美惠商城</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wnumgoods.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Waccount.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/FbMeihui.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.7.1.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.cookie.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wcanal.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/dtree/dtree.js"></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wproduct.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artTemplate/template.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC_LOCAL__/Js/My97DatePicker/WdatePicker.js?v=__VR__"></script>
<style>
.sidenav { height:70% !important;}
</style>
<style type="text/css">
.noInfo{ background:#f5f5f5; display:block; font-size:14px; line-height:24px; color:#666666; padding:20px 25px;}
.exclamation{ width:22px; height:22px; background:url(__PUBLIC__/Image/Wfx/exclamation.png) no-repeat; display:inline-block; vertical-align:middle; margin-right:5px;}
.grade{ background:#f15755; font-size:10px; color:#FFF; font-style:normal; padding:0 5px; line-height:16px; border-radius:2px; position:relative; margin-right:5px; font-weight:100}
.grade:after{top: 4px;right: -7px;border: solid transparent;content: " ";height: 0;width: 0;position: absolute;pointer-events: none;border-color: rgba(255, 255, 255, 0);border-left-color: #f15755;border-width: 4px;margin-left: -4px;}
.viewdetail{color:#3D86BA;}
.viewdetail:hover{cursor:pointer;color:#F15755;}
</style>
</head>
<body>
    <div id="wrapper">
    	<include file="./Home/Tpl/Public/Public_header.html" />  
        <!--开始引入头部菜单-->                   
        <div class="shopNav">
        <include file="./Home/Tpl/Wfx/topMenu.html" topmenuid="wfxjl"/>
        </div>
        <div id="container" class="bgfff" style="margin-top:10px;">
            <div id="main" class="rel">
                <div class="new_sidenav">
                    <include file="./Home/Tpl/Wfx/meihui/Meihui_sidenav.html" leftmenuid="mdqd"/>
                </div>
                <div class="subcon fn">
                	<div class="main-name fn"><h4>奖励发放明细</h4></div>
                    <div class="Wcanal-tab" id="Wcanal-tabon">
                        <div class="Wcanal-tab-title fn">
                            <p class="Wcanal-tab-hover first" id="p1"><a href="javascript:void(0);" onclick="loadingData(3)">招募奖励</a></p>
                            <p id="p2"><a href="javascript:void(0);" onclick="loadingData(1)">团队奖励</a></p>
                            <p id="p3"><a href="javascript:void(0);" onclick="loadingData(2)">月度排行</a></p>
                            <p id="p4" class="last"><a href="javascript:void(0);" onclick="loadingData(4)">差价提成</a></p>
                        </div>
                        <div class="cl pt20"></div>
                        <div class="SearchArea fn">
                            <form id="saler_form" action="{:U('Wfx/Fxgl/index',array('ps'=>1))}" method="post">
                                <input type="hidden" name="postFrom" value="saler" />
                                <div class="SearchAreaLeft">
                                    <label>
                                        <span>日期</span>
                                            <input type="text"  name="startMonth" id="startMonth" onclick="WdatePicker({dateFmt:'yyyyMM'})" value="{$startMonth}"/>
                                    </label>
                                    <label>
                                        <span>奖励获取人</span>
                                        <input type="text"  name="jlName" id="jlName"  value=""/>
                                    </label>
                                </div>
                                <div class="SearchAreaRight">
                                    <a href="javascript:void(0);" class="searchBtn" id="saler_sub_button">查询</a>
                                </div>
                            </form>
                        </div>
                        <input type="hidden" value="1" id="type"/>
                    <div class="Wcanal-tab-list mt15" id="d1"></div>
                    <div class="Wcanal-tab-list  mt15" style="display: none;" id="d2"></div>
                    <div class="Wcanal-tab-list  mt15" style="display: none;" id="d3"></div>
                    <div class="Wcanal-tab-list  mt15" style="display: none;" id="d4"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="service"></div>
    <include file="./Home/Tpl/Public/Public_footer.html" />
</body>
</html>
<script id="teamTrace" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">奖励金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="4" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="recruit" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover">直接下线</th>
            <th>直接下线手机号</th>
            <th>奖励获取人</th>
            <th>获取人手机号</th>
            <th>奖励金额</th>
            <th>支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.downName}}</td>
            <td>{{value.down_phone_no}}</td>
            <td>{{value.name}}</td>
            <td>{{value.phone_no}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="7" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="rank" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">月度排名</th>
            <th class="hover">奖励金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.ranking}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="5" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="settlement" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">订单金额</th>
            <th class="hover">会员价</th>
            <th class="hover">提成金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.order_amt}}</td>
            <td>{{value.member_price}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="6" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script>
    function loadingData(href) {
        var dialog=art.dialog({title:false,content:"<div class='msg-all-succeed'>"+"等待加载"+"</div>",fixed: true,padding:0});
        var url=href;
        var startMonth=$("#startMonth").val();
        var jlName=$("#jlName").val();
        var data={'startMonth':startMonth,'jlName':jlName};
        if(url=='1'){
            url="{:U('Wfx/Jlgl/getTeamTrace')}";
            $("#type").val(1);
        }else if(href=='2'){
            url="{:U('Wfx/Jlgl/getRankingTrace')}";
            $("#type").val(2);
        }else if(href=='3'){
            url="{:U('Wfx/Jlgl/getRecruitTrace')}";
            $("#type").val(3);
        }else if(href=='4'){
            url="{:U('Wfx/Jlgl/getSettlementTrace')}";
            $("#type").val(4);
        }
        $.post(url,data,function(resp){
            if(resp.status==1){
                if(resp.info.type==1){
                    var recruitInfo = template('recruit',resp.info);
                    $('#d1').html(recruitInfo);
                }else if(resp.info.type==2){
                    var teamTrace = template('teamTrace',resp.info);
                    $('#d2').html(teamTrace);
                }else if(resp.info.type==3){
                    var rankingTrace = template('rank',resp.info);
                    $('#d3').html(rankingTrace);
                }else if(resp.info.type==4){
                    var settlementTrace = template('settlement',resp.info);
                    $('#d4').html(settlementTrace);
                }
                dialog.close();
            }
        },"json");
    }
    $(document).ready(function() {
        loadingData("{:U('Wfx/Jlgl/getRecruitTrace')}");
    });
    $("#saler_sub_button").click(function(){
        var type=$("#type").val();
        if(type==1){
            loadingData(1);
        }else if(type==2){
            loadingData(2);
        }else if(type==3){
            loadingData(3);
        }else if(type==4){
            loadingData(4);
        }
    });
    $('#d1').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d2').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d3').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d4').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    function loadingData1(href) {
        var dialog=art.dialog({title:false,content:"<div class='msg-all-succeed'>"+"等待加载"+"</div>",fixed: true,padding:0});
        $.post(href,function(resp){
            if(resp.status==1){
                if(resp.info.type==1){
                    var recruitInfo = template('recruit',resp.info);
                    $('#d1').html(recruitInfo);
                }else if(resp.info.type==2){
                    var teamTrace = template('teamTrace',resp.info);
                    $('#d2').html(teamTrace);
                }else if(resp.info.type==3){
                    var rankingTrace = template('rank',resp.info);
                    $('#d3').html(rankingTrace);
                } else if(resp.info.type==4){
                    var settlementTrace = template('settlement',resp.info);
                    $('#d4').html(settlementTrace);
                }
                dialog.close();
            }
        },"json");
    }
</script>