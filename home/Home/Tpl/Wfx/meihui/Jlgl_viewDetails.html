<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>添加本层机构</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/FbMeihui.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.7.1.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.cookie.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artTemplate/template.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
</head>
<body>
<div class="Wcanal-tab Diabody" id="Wcanal-tabon">
<div class="Wcanal-tab-title fn">
    <p class="Wcanal-tab-hover first" id="p1"><a href="javascript:void(0);" onclick="loadingData(3)">招募奖励</a></p>
    <p id="p2"><a href="javascript:void(0);" onclick="loadingData(1)">团队奖励</a></p>
    <p id="p3"><a href="javascript:void(0);" onclick="loadingData(2)">月度排行</a></p>
    <p id="p4" class="last"><a href="javascript:void(0);" onclick="loadingData(4)">差价提成</a></p>
</div>
<div style="margin-top: 10px;">总计：<span id="total"></span></div>
<div class="Wcanal-tab-list mt15" id="d1" style="height: 400px;">
</div>
<div class="Wcanal-tab-list  mt15" style="display: none;" id="d2">
</div>
<div class="Wcanal-tab-list  mt15" style="display: none;" id="d3">
</div>
<div class="Wcanal-tab-list  mt15" style="display: none;" id="d4">
</div>
<input type="hidden" name="traceMonth" value="{$traceMonth}" id="traceMonth"/>
<input type="hidden" name="type" value="1" id="type"/>
<div class="cl db fn"></div>
<div class="DiabtnCon">
	<a href="javascript:art.dialog.close();" class="Diabtn-all-del">关闭</a>
    <a href="javascript:void(0);" class="Diabtn-all-del" id="down">下载明细</a>
</div>
</div>
</body>
</html>
<script id="teamTrace" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">奖励金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="4" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="recruit" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover">直接下线</th>
            <th>直接下线手机号</th>
            <th>奖励获取人</th>
            <th>获取人手机号</th>
            <th>奖励金额</th>
            <th>支付宝账号</th>
            <th>银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.downName}}</td>
            <td>{{value.down_phone_no}}</td>
            <td>{{value.name}}</td>
            <td>{{value.phone_no}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="7" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="rank" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">月度排名</th>
            <th class="hover">奖励金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.ranking}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="5" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script id="settlement" type="text/html">
    <table cellpadding="0" cellspacing="0" class="W-table">
        <tbody>
        <tr class="title">
            <th class="hover first">奖励获取人</th>
            <th class="hover">订单金额</th>
            <th class="hover">会员价</th>
            <th class="hover">提成金额</th>
            <th class="hover">支付宝账号</th>
            <th class="hover last">银行卡号</th>
        </tr>
        {{if hasData ==1}}
        {{each info as value i}}
        <tr>
            <td>{{value.name}}</td>
            <td>{{value.order_amt}}</td>
            <td>{{value.member_price}}</td>
            <td>{{value.amount}}</td>
            <td>{{value.alipay_account}}</td>
            <td>{{value.bank_account}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr class="info">
            <td colspan="6" class="last">
                <div class="nonedata"></div>
            </td>
        </tr>
        {{/if}}
        </tbody>
    </table>
    <div class="page">{{#page}}</div>
</script>
<script>
    function loadingData(href) {
        var dialog=art.dialog({title:false,content:"<div class='msg-all-succeed'>"+"等待加载"+"</div>",fixed: true,padding:0});
        var url=href;
        var traceMonth=$("#traceMonth").val();
        if(url=='1'){
            url="{:U('Wfx/Jlgl/getTeamTrace')}";
            $("#type").val(1);
            $("#d2").css("height","400px");
        }else if(href=='2'){
            url="{:U('Wfx/Jlgl/getRankingTrace')}";
            $("#type").val(2);
            $("#d3").css("height","400px");
        }else if(href=='3'){
            url="{:U('Wfx/Jlgl/getRecruitTrace')}";
            $("#type").val(3);
            $("#d1").css("height","400px");
        }else if(href=='4'){
            url="{:U('Wfx/Jlgl/getSettlementTrace')}";
            $("#type").val(4);
            $("#d4").css("height","400px");
        }
        var data={'startMonth':traceMonth};
        $.post(url,data,function(resp){
            if(resp.status==1){
                $("#total").text(resp.info.total);
                if(resp.info.type==1){
                    var recruitInfo = template('recruit',resp.info);
                    $('#d1').html(recruitInfo);
                }else if(resp.info.type==2){
                    var teamTrace = template('teamTrace',resp.info);
                    $('#d2').html(teamTrace);
                }else if(resp.info.type==3){
                    var rankingTrace = template('rank',resp.info);
                    $('#d3').html(rankingTrace);
                }else if(resp.info.type==4){
                    var settlementTrace = template('settlement',resp.info);
                    $('#d4').html(settlementTrace);
                }
                dialog.close();
            }
        },"json");
    }
    $(document).ready(function() {
        loadingData("{:U('Wfx/Jlgl/getRecruitTrace')}");
    });
    $("#down").click(function(){
        var type=$("#type").val();
        var traceMonth=$("#traceMonth").val();
        var url = "{:U('Wfx/Jlgl/downDetailType')}&traceMonth="+traceMonth+"&type="+type;
        window.location.href=url;
    });
    $('#d1').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d2').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d3').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    $('#d4').on('click', '.page a', function(){
        if($(this).hasClass('gobtns')){
            var href = $(this).data('href');
            var gop = $(this).prev('input').val();
            href = href.replace("__PAGE__",gop);
        }else{
            var href = $(this).data('href');
        }
        loadingData1(href);
    })
    function loadingData1(href) {
        var dialog=art.dialog({title:false,content:"<div class='msg-all-succeed'>"+"等待加载"+"</div>",fixed: true,padding:0});
        $.post(href,function(resp){
            if(resp.status==1){
                if(resp.info.type==1){
                    var recruitInfo = template('recruit',resp.info);
                    $('#d1').html(recruitInfo);
                }else if(resp.info.type==2){
                    var teamTrace = template('teamTrace',resp.info);
                    $('#d2').html(teamTrace);
                }else if(resp.info.type==3){
                    var rankingTrace = template('rank',resp.info);
                    $('#d3').html(rankingTrace);
                }else if(resp.info.type==4){
                    var settlementTrace = template('settlement',resp.info);
                    $('#d4').html(settlementTrace);
                }
                dialog.close();
            }
        },"json");
    }
</script>