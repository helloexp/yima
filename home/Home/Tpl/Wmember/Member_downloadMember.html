<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>会员导出</title>
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Whygl.css" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.7.1.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wcanal.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/validationEngine/languages/jquery.validationEngine-zh_CN.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/validationEngine/jquery.validationEngine.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<style type="text/css">
	html { height: auto;}
	.mark { display: none;}
	.Wcanal-tab .Wcanal-tab-title { margin-bottom: 15px;}
	.Wcanal-tab .Wcanal-tab-title .Wcanal-tab-hover, .Wcanal-tab .Wcanal-tab-title .Wcanal-tab-hover:hover { border-top: 3px #ed1c24 solid;}
	.userHeader-inner>img { float:left;/* margin-left:20px;*/ width:56px; height:56px; border-radius:50%; border:solid 2px #fff;}
	.userHeader-inner>p {/* padding:5px 0;*/ line-height:20px; font-size: 15px; font-weight: bold; text-align:left; text-indent:8px; color: #333333;}
	.userHeader-inner>p span {font-size: 14px; color: #666666; font-weight: normal;}
	.popupList,.steps { margin: 0 0 15px 0;}
	.popupList li { border: 1px #e8e8e8 solid; border-width: 0 1px 1px 1px; width: 49%; float: left;}
	.popupList li label { background: #f7f7f7; border-right: 1px #e8e8e8 solid;}
	.popupList li label,.popupList li span { display: inline-block; width: 49%; line-height: 40px; height: 40px; vertical-align: top; font-size: 16px; text-align: center;}
	.mb1 { width: 136px; height: 36px; line-height: 36px; text-align: center; font-size: 15px;}
	.sweet_tips i { display: inline-block; width: 18px; height: 18px; vertical-align: middle; margin-right: 5px; background: url(__PUBLIC__/Image/icon-dia.png) 0 0 no-repeat;}
	.sweet_tips { padding-left: 15px; margin: 0 auto 20px auto; border: none; padding: 10px 15px; color: #666666; background: #fef7ee; font-size: 12px; line-height: 24px;}
	.sweet_tips_top { width: 100%; position: absolute; top: 0; left: 0; padding: 10px 30px;}
	/*.down-list table td .checkdiv ul li.checked { border: solid 1px #cccccc;}*/
	.down-list table td .checkdiv ul li.disabled { border: solid 1px #ed3f41; background: #ffffff; color: #333333;}
	.down-list table td .checkdiv ul li.checked:after, .down-list table td .checkdiv ul li.disabled:after { visibility: inherit;}
	/*.down-list table td.title,.down-list table td .checkdiv ul li.disabled { display: none;}*/
	/*.down-list { width: 100%;}
	.down-list h6 { padding-left: 20px}*/
	.down-list { width: 690px;}
	.Diabody .Gform { margin: 45px 0 0 0; width: 690px;}
</style>
<script type="text/javascript">
	$(function(){
		$("body").on("click",".down-list .checkdiv li:not('.disabled')",function(){
            $(this).toggleClass("checked");
            $(this).hasClass("checked") ? $(this).find("input").attr("checked",true) : $(this).find("input").attr("checked",false);
            var checknum = $(this).closest("td").find(".checkdiv li.checked:not('.disabled')");
            var num = $(this).closest("td").find(".checkdiv li:not('.disabled')");
            var p = $(this).closest("td").prev("td").find("p");
            var allcheck = 0;
            num.each(function(index, element) {
                if(!$(this).hasClass("checked")){
                    allcheck = 1;
                }
            });
            if(checknum.length==0){
                allcheck=2;
            };
            if(checknum.length==num.length){
                allcheck=0;
            };
            if(allcheck==1){
                p.attr("class","nochecked")
            }else if(allcheck==2){
                p.attr("class","")
            }else if(allcheck==0){
                p.attr("class","checked")
            }
        });

		$("body").on("click",".down-list td.title p:not('.disabled')",function(){
            var li = $(this).closest("td").next("td").find(".checkdiv li:not('.disabled')");
            $(this).removeClass("nochecked");
            $(this).toggleClass("checked");
            if($(this).hasClass("checked")){
                li.each(function(index, element) {
                    $(this).addClass("checked");
                    $(this).find("input").attr("checked",true);
                });
            }else{
                li.each(function(index, element) {
                    $(this).removeClass("checked");
                    $(this).find("input").attr("checked",false);
                });
            }
        });
	});
	
	$(function(){
		Gform();
		
		$("#smb").click(function(){
			var li_data = $(".checkdiv li:not('.disabled')");

			var title_str = "";
			var val_str = "";
			li_data.each(function(index, element) {
                if($(this).hasClass("checked")){
                	if(title_str == '') {
                		title_str = $(this).attr("data-val");
                		val_str = $(this).attr("data-f");
                	} else {
                		title_str += ","+$(this).attr("data-val");
                		val_str += ","+$(this).attr("data-f");
                	}
                }
            });

			if(title_str == "") {
				dialog = art.dialog({title:false,content:"<div class='msg-all-error'>请选择需要下载的字段~~</div>",fixed: true,padding:0});
				dialog.time(2);
				return false;
			}

            window.location.href = "{:U('downloadMember')}&field_title="+title_str+"&field="+val_str;
		});
	});
</script>
</head>
<body>
<div class="popupWin">
<div class="Wcanal-tab db" id="Wcanal-tabon">
	<div class="sweet_tips sweet_tips_top"><i></i>共<span class="red">{$member_num}</span>个会员</div>
	<div class="Gform">
		<form id="theform" action="" method="" name="form">
			<div class="down-list">
	            <h6>请选择您需要下载的数据项</h6>
	            <table cellpadding="3">
	                <tr>
	                    <td class="title"><p class="checked"><i></i><span>基础信息</span></p></td>
	                    <td>
	                        <div class="checkdiv">
	                            <ul>
	                                <li class="checked" data-val="手机号码" data-f="phone_no">手机号码<input type="checkbox" checked="checked" /></li>
	                                <li class="checked" data-val="姓名" data-f="name">姓名<input type="checkbox" checked="checked" /></li>
	                                <li class="checked" data-val="性别" data-f="sex">性别<input type="checkbox" checked="checked" /></li>
	                                <li class="checked" data-val="出生日期" data-f="birthday">出生日期<input type="checkbox" checked="checked" /></li>
	                                <li class="checked" data-val="所在区域" data-f="address">所在区域<input type="checkbox" checked="checked" /></li>
	                                <if condition="$adb_flag eq 1">
	                                <li class="checked" data-val="所属门店" data-f="store_short_name">所属门店<input type="checkbox" checked="checked" /></li>
	                                </if>
	                            </ul>
	                        </div>
	                    </td>
	                </tr>
	                <tr>
	                	<td class="title"><p class="checked"><i></i><span>微信资料</span></p></td>
	                    <td>
	                        <div class="checkdiv">
	                            <ul>
	                                <li class="checked" data-val="微信昵称" data-f="nickname">微信昵称<input type="checkbox" checked="checked" /></li>
	                            </ul>
	                        </div>
	                    </td>
	                </tr>
	                <tr>
	                    <td class="title"><p class="checked"><i></i><span>会员卡</span></p></td>
	                    <td>
	                        <div class="checkdiv">
	                            <ul>
	                                <li class="checked" data-val="会员卡" data-f="card_name">会员卡<input type="checkbox" checked="checked" /></li>
	                                <li class="checked" data-val="会员卡号" data-f="member_num">会员卡号<input type="checkbox" checked="checked" /></li>
	                                <li class="" data-val="剩余积分" data-f="point">剩余积分<input type="checkbox" checked="checked" /></li>
	                            </ul>
	                        </div>
	                    </td>
	                </tr>
	                <tr>
	                	<td class="title"><p class=""><i></i><span>行为数据</span></p></td>
	                    <td>
	                        <div class="checkdiv">
	                            <ul>
	                                <li class="" data-val="活动参与数" data-f="join_cnt">活动参与数<input type="checkbox" checked="checked" /></li>
	                                <li class="" data-val="接受卡券数" data-f="send_cnt">接受卡券数<input type="checkbox" checked="checked" /></li>
	                                <li class="" data-val="到店核销数" data-f="verify_cnt">到店核销数<input type="checkbox" checked="checked" /></li>
	                                <!-- <li class="" data-val="" data-f="">购物次数(不支持)<input type="checkbox" /></li> -->
	                            </ul>
	                        </div>
	                    </td>
	                </tr>
	                <tr>
	                	<td class="title"><p class="checked"><i></i><span>其它</span></p></td>
	                    <td>
	                        <div class="checkdiv">
	                            <ul>
	                                <li class="checked" data-val="登记日期" data-f="add_time">登记日期<input type="checkbox" checked="checked" /></li>
	                                <li class="" data-val="首次来源" data-f="channel_name">首次来源<input type="checkbox" checked="checked" /></li>
	                                <li class="" data-val="最后一次登录" data-f="update_time">最后一次登录<input type="checkbox" checked="checked" /></li>
	                                <!-- <li class="" data-val="" data-f="">最后一次购物(不支持)<input type="checkbox" /></li> -->
	                            </ul>
	                        </div>
	                    </td>
	                </tr>
	            </table>
	        </div>
                <div class="DiabtnCon">
		            <a href="javascript:void(0)" class="Diabtn-all" id="smb">确认下载</a>
		            <a href="javascript:art.dialog.close();" class="Diabtn-all-del" id="cancel">取消</a>
		        </div>
        </form>
    </div>
</div>
</div>
</body>
</html>