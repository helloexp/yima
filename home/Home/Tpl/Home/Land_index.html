<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>翼码旺财注册-{:C('SITE_TITLE')}</title>
<meta name="keywords" content="{:C('SITE_KEYWORDS')}" />
<meta name="description" content="{:C('SITE_DESCRIPTION')}"/>
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css">
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css">
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css">
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<load href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.7.1.min.js?v=__VR__"/></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wcanal.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<js href="__PUBLIC__/Js/validationEngine/languages/jquery.validationEngine-zh_CN.js?v=__VR__" />
<js href="__PUBLIC__/Js/validationEngine/jquery.validationEngine.js?v=__VR__" />
<script type="text/javascript" src="__PUBLIC__/Js/citycode.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<style>
body{ min-height:auto; min-height:500px; overflow:hidden}
.RegForm .Wcanal-tab .Wcanal-tab-list {border-top: solid 0px #e5e5e5;margin-top: -2px;}
.RegForm .Wcanal-tab .Wcanal-tab-title p{ margin-left:0; border:0px #dfdfdf solid;  font-size:16px; height:38px; line-height:38px; padding:0; background:none;color: #ed1c24; border: solid 1px #eee;   background: #fff; height: 36px; line-height: 38px;}
.RegForm  .Wcanal-tab .Wcanal-tab-title p a{display:block; float:none; line-height:35px;}
.RegForm  .Wcanal-tab .Wcanal-tab-title p.last{border-left:0}
.RegForm  .Wcanal-tab .Wcanal-tab-title p.last a{display:block; float:none; line-height:35px;}
.RegForm .spreadLogin { margin:0 auto; /*margin-top:40px;*/ padding:30px 0px 20px 0px; width:458px; height:auto; overflow:hidden; background:#fff; border:solid 1px #eee; border-top:0}
.spreadLogin:after,.spreadLogin ul:after,.spreadLogin ul li:after {visibility:hidden;display:block;font-size:0;content:"";clear:both;height:0px;}
.RegForm .spreadLogin ul { width:100%; position:relative;}
.RegForm .spreadLogin .name { width:100px; text-align:right; line-height:28px; position:absolute; top:8px; left:0; font-size:14px; color:#666;}
.RegForm .spreadLogin .input { padding:8px 0 8px 100px; position:relative;}
.RegForm .spreadLogin .input .txt-tips { display:block;line-height: 16px; padding:6px 0 0 0; font-size:12px; color:#ccc; font-family:"宋体";}
.RegForm .spreadLogin .input .textbox { width:240px;}
.RegForm .spreadLogin .input select { width:120px; margin:0; height:30px; line-height:30px;}
.RegForm .spreadLogin .input select.ml { margin-left:7px;}
.RegForm .spreadLogin ul li.btn { text-align:left; padding-top:20px;}
.RegForm .spreadLogin ul li a.btn-zc { margin-left:99px; display:inline-block; *display:inline; *zoom:1; padding:10px 90px; font-size:18px; background:#ff5a5a; color:#fff; border-radius:2px;}
.RegForm .spreadLogin ul li a.btn-zc:hover { text-decoration:none; background:#fd4949;}
.RegForm .spreadLogin ul li.btn span { display:block;  text-align:center; line-height:50px; font-size:14px;}
.RegForm .spreadLogin ul li.btn span em { color:#ff0000;}
</style>

<style>
.RegForm .login-form{width:50%; }
.RegForm .input-box{position:relative;}
.RegForm .input-box i{display:block;width:20px;height:20px;position:absolute;left:20px;background-image:url(__PUBLIC__/Image/icon-extension.png);background-repeat:no-repeat;}
.RegForm .input-box .login-icon{top:19px;background-position:0 -16px;}
.RegForm .input-box .pwd-icon{top:26px;background-position:0 -70px;}
.RegForm .login-box{position:relative;width:458px;height:386px; margin:0px auto;border:1px solid #e9e9e9; border-top:0;background-color:#fff;}
.RegForm .login-box form{width:350px;padding-top:40px;margin:0 auto;font-family:'宋体';color:#999;font-size:14px;}
.RegForm .login-box form input[type=text],.RegForm .login-box input[type=password]{border-width:1px;border-style:solid;border-color:#dedede;height:20px; padding:18px 50px;line-height:20px;-webkit-transition:border-color 0.5s,box-shadow 0.5s;-o-transition:border-color 0.5s,box-shadow 0.5s;-moz-transition:border-color 0.5s,box-shadow 0.5s;transition:border-color 0.5s,box-shadow 0.5s;}
.RegForm .login-box form input:focus{border-color:#aaa;box-shadow:0 0 1px rgba(0,0,0,0.6);}
.RegForm .u-name{width:248px;padding:16px 34px 16px 66px;}
.RegForm .pwd{width:248px;padding:16px 34px 16px 66px;}
.RegForm .verify{width:134px;padding:16px 20px;}
.RegForm .btn-sub{width:350px;height:42px;background-color:#ff5a5a;color:#fff;text-align:center;line-height:40px;font-size:16px;border:1px solid #ff0303;cursor:pointer;border-radius:2px;}
.RegForm .btn-sub:hover{background-color:#fd4949;}

.Wcanal-tab .Wcanal-tab-title  p.Wcanal-tab-hover, 
.Wcanal-tab .Wcanal-tab-title  p.Wcanal-tab-hover:hover,
.Wcanal-tab .Wcanal-tab-title  p.Wcanal-tab-hover:hover{
  color: #ed1c24;
  border: solid 1px #eee;
  background: #fff;
  border-bottom: 0;
  border-top: 3px #ed1c24 solid;
}
.Wcanal-tab .Wcanal-tab-title{ height:37px;}
</style>
</head>
<body>
<div class="RegForm pt10">
<div class="Wcanal-tab" id="Wcanal-tabon" name="Wcanal-tabon">
<div class="Wcanal-tab-title fn" style="width: 460px; margin:0 auto">
<p class="<?php if($reg_login != 1) { echo 'Wcanal-tab-hover'; } ?>" style="width:50%; box-sizing:border-box" align="center"><a href="javascript:void(0);">注册</a></p>
<p class="<?php if($reg_login == 1) { echo 'Wcanal-tab-hover'; } ?> last" style="width:50%;box-sizing:border-box; background:none" align="center"><a href="javascript:void(0);">登录</a></p>
</div>

<?php if($reg_login == 1) { ?>
<div class="Wcanal-tab-list" style="display:none;">
<?php } else { ?>
<div class="Wcanal-tab-list" style="display:block;">
<?php } ?>
<div class="spreadLogin">
    <form method="post" id="ginoForm">
    <input type="hidden" name="landname" value="{$landname}" />
    <input type="hidden" name="from_user_id" value="{$fromuid}" />
    <ul>
        <li class="name">用户名：</li>
        <li class="input">
            <input name="email" type="text" class="textbox validate[required,custom[email]]" value="" placeholder="用户名需使用邮箱格式,用于接收密码">
        </li>
    </ul>
    <ul>
        <li class="name">密码：</li>
        <li class="input">
            <input name="user_password" type="password" class="textbox validate[required,minSize[6],maxSize[16]]" value=""  placeholder="请输入密码（≥6个字符）">
        </li>
    </ul>
     <ul>
        <li class="name">确认密码：</li>
        <li class="input">
            <input name="re_password" type="password" class="textbox validate[required,equals[user_password]]" maxlength="16" value=""  placeholder="请确认密码">
        </li>
    </ul>
    <ul>
        <li class="name">企业名称：</li>
        <li class="input">
            <input name="name" type="text" class="textbox validate[required,maxSize[60]]" value="" placeholder="请填写营业执照上的企业名称">
        </li>
    </ul>
    <ul>
        <li class="name">姓名：</li>
        <li class="input">
            <input name="contacts" type="text" class="textbox validate[required,maxSize[20]]" value="" placeholder="业务负责人姓名,注册后进入账户中心可变更信息">
        </li>
    </ul>
    <ul>
        <li class="name">手机：</li>
        <li class="input">
            <input name="mobile" type="text" class="textbox validate[required,custom[chinamobile]]" value="" placeholder="业务负责人手机号">
        </li>
    </ul>
    <ul>
        <li class="name">所在城市：</li>
        <li class="input">
            <select name="province_code" id="province_code" class="validate[required]"></select>
            <select name="city_code" id="city_code" class="ml validate[required]"></select>
        </li>
    </ul>
    <ul>
        <li class="btn">
            <a href="javascript:void(0)" id="smb" class="btn-zc">立即注册</a>
            <br>
            <span>联系我们：<em>400-882-7770</em></span>
        </li>
    </ul>
    <input name="client_manager" id="client_manager" value='{$client_manager}' type="hidden">
    <input name="tg_id" id="tg_id" value='{$tg_id}' type="hidden">
    </form>
</div>
</div>

<?php if($reg_login == 1) { ?>
<div class="Wcanal-tab-list" style="display:block;">
<?php } else { ?>
<div class="Wcanal-tab-list" style="display:none;">
<?php } ?>
<div class="login-box ">
    <form method="post" id="loginform" name="loginform">
    <input type="hidden" name="landname" value="{$landname}" />
    <div class="input-box">
            <i class="login-icon"></i>
        <input type="text" class="u-name validate[required]" name="email" id="email" placeholder="用户名" value="">
    </div>
        <div class="input-box">
            <i class="pwd-icon"></i>
            <input type="password" name="password" id="password" class="pwd mt10 validate[required]" placeholder="密码">
        </div>
        <div id="verify_div">
        </div>
        <p class="mt15 fn"><label class="l"><input type="checkbox" class="vm mr5" name="rememberMe" id="rememberMe" value="1" checked=""><span class="vm">记住用户名</span></label><a class="r" href="javascript:void(0);" onclick="rfun()" style="color:#999;">忘记密码？</a></p>
        <input type="button" class="btn-sub mt15" id="loginsub" value="登录">
    </form>
</div>
</div>

</div>
</div>
</body>
</html>

<script>
var requestLoginError = function() {
    $.ajax({
           type: "POST",
           url: "{:U('Home/Login/ajaxLoginError')}",
           success: callbackLoginError,
           dataType:"json"
    });
}
var callbackLoginError = function(data) {
    if (data['loginError'] != -1) {
        var verifyImgSrc = "{:U('Home/Verifycode/verify',array('_t'=>time()))}";
        $('#verify_div').html('<input style="padding:18px 20px;" type="text" class="verify mt10 validate[required]" placeholder="验证码" name="verify" id="verify" value="" maxlength="4" /><img id="verifyImg" src="'+verifyImgSrc+'" onclick="fleshVerify()" class="ml10" style="vertical-align:middle; height:32px;cursor:pointer;" />');
    }
}

var callbackLogin = function(data) {
    if (typeof(data['success']) != 'undefined' && data['success'] == 0) {
        art.dialog({title:false,time:5,content:"<div class='msg-all-error' style='color:red'>"+data['error_msg']+"</div>",fixed: true,padding:0});
        var verifyImgSrc = "{:U('Home/Verifycode/verify',array('_t'=>time()))}";
        $('#verify_div').html('<input style="padding:18px 20px;" type="text" class="verify mt10 validate[required]" placeholder="验证码" name="verify" id="verify" value="" maxlength="4" /><img id="verifyImg" src="'+verifyImgSrc+'" onclick="fleshVerify()" class="ml10" style="vertical-align:middle; height:32px;cursor:pointer;" />');
        $('#verifyImg').click();
    } else {
        top.location.href = data['redirectUrl'];
    }
}

function fleshVerify(){ 
    //重载验证码
    var time = new Date().getTime();
        document.getElementById('verifyImg').src= '{:U("Home/Verifycode/verify")}&time='+time;
 }

function rfun() {
    top.location.href = "{:U('Home/ForgetPwd/index')}";
}

$(document).ready(function(e) { 
	//省市区初始化
    CityCode({
        province:$("#province_code"),//省
        city:$("#city_code"),//市
        selected:"{:$info['province_code'].$info['city_code'].$info['town_code']}",//默认选中的省市区代号
        url:"{:U('LabelAdmin/AjaxCity/index')}"//数据查询页
    });
    $('#ginoForm').validationEngine({
        promptPosition:"topLeft:5,0",
        scroll:false,
        focusFirstField: false
    });
    $("#smb").click(function(){
        var t = $("#ginoForm").validationEngine("validate");
        if(!t) return false;
        dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",fixed: true,padding:0});
        $.ajax({
            type: "POST",
            data:$('#ginoForm').serialize(),
            url: "{:U('WebPromotion/Promotion/registration')}",
            dataType:"json",
            success: function(data) {
                if(data.status == '0') {
                    dialog.time(5).content("<div class='msg-all-error'>"+data.info+"</div>");
                }
                if(data['success'] == 1) {
                    top.location.href = data['redirectUrl'];
                }
            }
        });
    });

    $("#loginsub").click(function(){
        var t = $("#loginform").validationEngine("validate");
        if(!t) return false;
        $.ajax({
            type: "POST",
            data:$('#loginform').serialize(),
            url: "{:U('Home/Login/ssologin')}",
            success: callbackLogin,
            error:function(XMLHttpRequest, textStatus, errorThrown){
                alert('通信错误，请重新登录');
                window.location.href=window.location.href;
            },
            dataType:"json"
        });
    });

    requestLoginError();
    $('#email,#password').keydown(function(event){
        if(event.keyCode == 13){ //绑定回车
            $("#loginsub").click();
        }
    });

    $('#verify_div input').live('keydown', function(event){
        if(event.keyCode == 13){ //绑定回车
            $("#loginsub").click();
        }
    });
});
</script>
</div>