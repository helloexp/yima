<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>翼码旺财注册-{:C('SITE_TITLE')}</title>
<meta name="keywords" content="{:C('SITE_KEYWORDS')}" />
<meta name="description" content="{:C('SITE_DESCRIPTION')}"/>
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css">
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css">
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css">
<load href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.8.2.min.js?v=__VR__"/></script>
<js href="__PUBLIC__/Js/validationEngine/languages/jquery.validationEngine-zh_CN.js?v=__VR__" />
<js href="__PUBLIC__/Js/validationEngine/jquery.validationEngine.js?v=__VR__" />
<script type="text/javascript" src="__PUBLIC__/Js/citycode.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<style>
<style>
html{height: auto}
body{ border:solid 5px #d1d1d1; z-index:100; overflow:hidden; position:relative;height:584px }
.RegForm .spreadLogin { margin:0 auto; padding:26px 0px 10px 0px; width:458px; height:auto; overflow:hidden; background:#fff; border:none; }
.spreadLogin:after,.spreadLogin ul:after,.spreadLogin ul li:after {visibility:hidden;display:block;font-size:0;content:"";clear:both;height:0px;}
.RegForm .spreadLogin ul { width:100%; position:relative;}
.RegForm .spreadLogin .name { width:100px; text-align:right; line-height:34px; position:absolute; top:8px; left:-10px; font-size:14px; color:#666;}
.RegForm .spreadLogin .input { padding:8px 0 8px 100px; position:relative;}
.RegForm .spreadLogin .input .txt-tips { display:block;line-height: 16px; padding:6px 0 0 0; font-size:12px; color:#ccc; }
.RegForm .spreadLogin .input input{ height:26px; line-height:26px;}
.RegForm .spreadLogin .input .textbox { width:310px;}
.RegForm .spreadLogin .input select { width:101px; margin:0; height:32px; line-height:32px; padding:3px 0;}
.RegForm .spreadLogin .input select.ml { margin-left:7px;}
.RegForm .spreadLogin ul li.btn { text-align:left; padding-top:10px; text-align:center;}
.RegForm .spreadLogin ul li a.btn-zc { margin:0 auto; display:inline-block; *display:inline; text-align:center; padding:10px 0px; font-size:18px; background:#ff5a5a; color:#fff; border-radius:2px; width:310px;}
.RegForm .spreadLogin ul li a.btn-zc:hover { text-decoration:none; background:#fd4949;}
.RegForm .spreadLogin ul li.btn span { display:block;  text-align:center; line-height:50px; font-size:14px;}
.RegForm .spreadLogin ul li.btn span em { color:#ff0000;}
.tips{height:38px; background:#fff6eb; padding:8px 15px 15px 15px; width:430px; font-size:12px; color:#666; line-height:22px; margin-top:10px;}
</style>

<style>
.RegForm .login-form{width:50%;}
.RegForm .input-box{position:relative;}
.RegForm .input-box i{display:block;width:20px;height:20px;position:absolute;left:20px;background-image:url(__PUBLIC__/Image/icon-extension.png);background-repeat:no-repeat;}
.RegForm .input-box .login-icon{top:19px;background-position:0 -16px;}
.RegForm .input-box .pwd-icon{top:26px;background-position:0 -70px;}
.RegForm .login-box{position:relative;width:458px;height:386px;background-color:#fff;}
.RegForm .login-box form{width:350px;padding-top:40px;margin:0 auto;color:#999;font-size:14px;}
.RegForm .login-box form input[type=text],.RegForm .login-box input[type=password]{border-width:1px;border-style:solid;border-color:#dedede;height:20px; padding:18px 50px;line-height:20px;-webkit-transition:border-color 0.5s,box-shadow 0.5s;-o-transition:border-color 0.5s,box-shadow 0.5s;-moz-transition:border-color 0.5s,box-shadow 0.5s;transition:border-color 0.5s,box-shadow 0.5s;}
.RegForm .login-box form input:focus{border-color:#aaa;box-shadow:0 0 1px rgba(0,0,0,0.6);}
.RegForm .u-name{width:248px;padding:16px 34px 16px 66px;}
.RegForm .pwd{width:248px;padding:16px 34px 16px 66px;}
.RegForm .verify{width:134px;padding:16px 20px;}
.RegForm .btn-sub{width:350px;height:42px;background-color:#ff5a5a;color:#fff;text-align:center;line-height:40px;font-size:16px;border:1px solid #ff0303;cursor:pointer;border-radius:2px;}
.RegForm .btn-sub:hover{background-color:#fd4949;}
.Wcanal-tab .Wcanal-tab-title p a{float:none;font-weight: bold;font-size: 14px;}
.Wcanal-tab .Wcanal-tab-title .Wcanal-tab-hover a{color: #ed3f41;text-align: center;display:block;width: 100%;padding: 0; }
.Wcanal-tab .Wcanal-tab-title .Wcanal-tab-hover{border-top: 2px solid #ed3f41;}
.Wcanal-tab .Wcanal-tab-title .Wcanal-tab-hover:hover{border: none;border-top: 2px solid #ed3f41;}
.aui_close{top:20px;right:20px;}
</style>
</head>
<body>
<div class="RegForm">
<div class="Wcanal-tab" id="Wcanal-tabon" name="Wcanal-tabon">
<div class="Wcanal-tab-title fn">
<p class="<?php if($reg_login != 1) { echo 'Wcanal-tab-hover'; } ?>" style="width:49.5%" align="center"><a href="javascript:void(0);">申请条码支付</a></p>
<p class="<?php if($reg_login == 1) { echo 'Wcanal-tab-hover'; } ?>" style="width:50%" align="center"><a href="javascript:void(0);">登录旺财</a></p>
</div>

<?php if($reg_login == 1) { ?>
<div class="Wcanal-tab-list" style="display:none;">
<?php } else { ?>
<div class="Wcanal-tab-list" style="display:block;">
<?php } ?>
<div class="spreadLogin">
    <form method="post" id="ginoForm">
    <input type="hidden" name="landname" value="{$landname}" />
    <input type="hidden" name="from_user_id" value="{$fromuid}" />
    <ul>
        <li class="name">企业名称</li>
        <li class="input">
            <input name="name" type="text" class="textbox validate[required,maxSize[30]]" value="" placeholder="请填写营业执照上的名称">
            
        </li>
    </ul>
     <ul>
        <li class="name">邮箱</li>
        <li class="input">
            <input name="email" type="text" class="textbox validate[required,maxSize[30],custom[email]]" value=""  placeholder="请填写您的邮箱">
           
        </li>
    </ul>
    <ul>
        <li class="name">姓名</li>
        <li class="input">
            <input name="contacts" type="text" class="textbox validate[required]" value=""  placeholder="请填写您的姓名">
           
        </li>
    </ul>
      <ul>
        <li class="name">手机</li>
        <li class="input">
            <input name="mobile" type="text" class="textbox validate[required,custom[phone]]" maxlength="11" value=""  placeholder="请填写您的手机号码">
        </li>
    </ul>
    <ul>
        <li class="name">密码</li>
        <li class="input">
            <input name="user_password" id="user_password" type="password" class="textbox validate[required,minSize[6]" maxlength="16" value=""  placeholder="请填写您的登录密码">
        </li>
    </ul>
     <ul>
        <li class="name">确认密码</li>
        <li class="input">
            <input name="re_password" type="password" class="textbox validate[required,equals[user_password]" value=""  placeholder="请确认您的登录密码">
        </li>
    </ul>
   
    
    <ul>
        <li class="name">所在城市</li>
        <li class="input">
            <select name="province_code" id="province_code" class="validate[required]"></select>
            <select name="city_code" id="city_code" class="ml validate[required]"></select>
            <select name="town_code" id="town_code" class="ml validate[required]"></select>
        </li>
    </ul>
    

	    <ul>
    	<li class="tips">
        	为了您能顺利开通条码支付并接收到支付宝账单，将为您默认开通旺财平台。您的邮箱即为旺财用户名。
        </li>
    </ul>
     <ul>
       
        <li style=" font-size:12px; line-height:14px; margin-top:15px; text-align:center;"> <input type="checkbox" name="radio" checked="true" style="margin-right:10px; vertical-align:middle; display:inline-block">我已阅读并同意<a href="{:U('Home/Agree/index')}" target="_blank">《旺财用户注册须知》</a>& <a href="{:U('Home/Agree/alipay')}" target="_blank">《条码支付用户须知》</a></li>
    </ul>
    <ul>
        <li class="btn">
            <a href="javascript:void(0)" id="smb" class="btn-zc">提交</a>
        </li>
    </ul>
    <input name="client_manager" id="client_manager" value='{$client_manager}' type="hidden">
    <input name="tg_id" id="tg_id" value='{$tg_id}' type="hidden">
    </form>
</div>
</div>

<?php if($reg_login == 1) { ?>
<div class="Wcanal-tab-list" style="display:block;">
<?php } else { ?>
<div class="Wcanal-tab-list" style="display:none;">
<?php } ?>
<div class="login-box ">
    <form method="post" id="loginform" name="loginform">
    <input type="hidden" name="landname" value="{$landname}" />
    <div class="input-box">
            <i class="login-icon"></i>
        <input type="text" class="u-name validate[required]" name="email" id="email" placeholder="用户名" value="">
    </div>
        <div class="input-box">
            <i class="pwd-icon"></i>
            <input type="password" name="password" id="password" class="pwd mt10 validate[required]" placeholder="密码">
        </div>
        <div id="verify_div">
        </div>
        <p class="mt15 fn"><label class="l"><input type="checkbox" class="vm mr5" name="rememberMe" id="rememberMe" value="1" checked=""><span class="vm">记住用户名</span></label><a class="r" href="{:U('Home/ForgetPwd/index')}" style="color:#999;" target="_blank">忘记密码？</a></p>
        <input type="button" class="btn-sub mt15" id="loginsub" value="登录">
    </form>
</div>
</div>

</div>
</div>
</body>
</html>

<script>
var requestLoginError = function() {
    $.ajax({
           type: "POST",
           url: "{:U('Home/Login/ajaxLoginError')}",
           success: callbackLoginError,
           dataType:"json"
    });
}
var callbackLoginError = function(data) {
    if (data['loginError'] != -1) {
        var verifyImgSrc = "{:U('Home/Verifycode/verify',array('_t'=>time()))}";
        $('#verify_div').html('<input style="padding:18px 20px;" type="text" class="verify mt10 validate[required]" placeholder="验证码" name="verify" id="verify" value="" maxlength="4" /><img id="verifyImg" src="'+verifyImgSrc+'" onclick="fleshVerify()" class="ml10" style="vertical-align:middle; height:32px;cursor:pointer;" />');
    }
}

var callbackLogin = function(data) {
    if (data['success'] == 0) {
        art.dialog({title:false,time:5,content:"<div class='msg-all-error' style='color:red'>"+data['error_msg']+"</div>",fixed: true,padding:0});
        var verifyImgSrc = "{:U('Home/Verifycode/verify',array('_t'=>time()))}";
        $('#verify_div').html('<input style="padding:18px 20px;" type="text" class="verify mt10 validate[required]" placeholder="验证码" name="verify" id="verify" value="" maxlength="4" /><img id="verifyImg" src="'+verifyImgSrc+'" onclick="fleshVerify()" class="ml10" style="vertical-align:middle; height:32px;cursor:pointer;" />');
        $('#verifyImg').click();
    } else {
        top.location.href = data['redirectUrl'];
    }
}

function fleshVerify(){ 
    //重载验证码
    var time = new Date().getTime();
        document.getElementById('verifyImg').src= '{:U("Home/Verifycode/verify")}&time='+time;
 }

$(document).ready(function(e) {
	//省市区初始化
    CityCode({
        province:$("#province_code"),//省
        city:$("#city_code"),//市
        selected:"{:$info['province_code'].$info['city_code'].$info['town_code']}",//默认选中的省市区代号
        url:"{:U('LabelAdmin/AjaxCity/index')}"//数据查询页
    });
    $('#ginoForm').validationEngine({
        promptPosition:"topLeft:5,0",
        scroll:false,
        focusFirstField: false
    });
    $("#smb").click(function(){
        var t = $("#ginoForm").validationEngine("validate");
        if(!t) return false;
        dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",fixed: true,padding:0});

        $.ajax({
            type: "POST",
            data:$('#ginoForm').serialize(),
            url: "{:U('WebPromotion/Promotion/registration')}",
            dataType:"json",
            success: function(data) {
                // if(data.status == '0') {
                //     dialog.time(5).content("<div class='msg-all-error'>"+data.info+"</div>");
                // }
                if(typeof(data['success']) != 'undefined' && data['success'] == 1) {
                    top.location.href = data['redirectUrl'];
                }else{
                    dialog.time(5).content("<div class='msg-all-error'>"+data.info+"</div>");
                }
            }
        });
    });

    $("#loginsub").click(function(){
        var t = $("#loginform").validationEngine("validate");
        if(!t) return false;
        $.ajax({
            type: "POST",
            data:$('#loginform').serialize(),
            url: "{:U('Home/Login/ssologin')}",
            success: callbackLogin,
            error:function(XMLHttpRequest, textStatus, errorThrown){
                alert('通信错误，请重新登录');
                window.location.href=window.location.href;
            },
            dataType:"json"
        });
    });

    requestLoginError();
    $('#email,#password').keydown(function(event){
        if(event.keyCode == 13){ //绑定回车
            $("#loginsub").click();
        }
    });

    $('#verify_div input').live('keydown', function(event){
        if(event.keyCode == 13){ //绑定回车
            $("#loginsub").click();
        }
    });
});
</script>
</div>