<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>个人资料</title>
<meta name="viewport" content="width=320, maximum-scale=1, user-scalable=no">
<meta content="O2O,O2O营销,二维码,旺财,市场调研" name="Keywords">
<meta content="telephone=no" name="format-detection" />
<meta content="email=no" name="format-detection" />
<meta name="apple-touch-fullscreen" content="NO">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Label/Css/wap_jfyx.css?v=__VR__">
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.7.2.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Label/Js/validationEngine/jquery.validationEngine.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Label/Js/validationEngine/jquery.validationEngine-zh_CN.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/citycode.js?v=__VR__"></script>

<style type="text/css">
	body {padding-bottom: 70px;}
	.item {width:100%;max-width:640px;}
	.item ul.btn-ul {margin:8px 15px;}
	.Gform .copyright {width:100%;max-width:640px;text-align:center margin-bottom:0;}
	.Gform .item.bottom {width: 100%;position:fixed; bottom:0;text-align:center;margin-bottom:0;}
	.Gform .item .input label.active:after {top:4px;}
	span.textbox input,.Gform .input select {font-size:16px;line-height:20px;text-align:left}
	.Gform .clause {margin:0 0 0 15px;}
	.Gform .cj_items  ul li.input select{float:left;text-align:left}
</style>
</head>
<body>
<div id="wrapper">
    <div id="container">
        <div id="header" class="userCenter fn">
        	<div class="goback"><a href="{:U('Label/Member/index',array('node_id'=>$node_id))}"><i></i></a></div>
            <div class="logo"><span>个人资料</span></div>
        </div>
        <div id="main">
            <div id="mainCon">
            	<div class="Gform">
                	<form id="form" action="" method="post" name="form">
                		<div class="item">
                			<ul>
		                        <li class="name w72">手机号</li>
		                        <li class="input pl72">
		                        <span class="textbox">{$member_info.phone_no}
		                        </span>
		                        </li>
		                    </ul>
		                </div>
                		<div class="item">
							<eq name="name" value="1">
								<ul>
									<input type="hidden" value="1" name="name_"/>
									<li class="name w72">姓名</li>
									<li class="input pl72 fn"><span class="textbox"><input type="text" id="name" name="name" value="{$member_info.name}"  /></span></li>
								</ul>
							</eq>
							<eq name="sex" value="1">
								<ul class="clause">
									<input type="hidden" value="1" name="sex_"/>
									<li class="name w72"><span>性别</span></li>
									<li class="input radioBox" style="padding: 12px 0 12px 80px;">
										<label  class="sex1 <?php if ($member_info['sex'] == '2') { ?> active <?php } ?>" ><input type="radio" name="sex1"  value="2" />女</label>
										<label class="sex2 <?php if ($member_info['sex'] == '1') { ?> active <?php } ?>" ><input type="radio"  name="sex2"  value="1" />男</label>
									</li>
								</ul>
							</eq>

							<eq name="birthday" value="1">
								<ul>
									<input type="hidden" value="1" name="birthday_"/>
									<li class="name w72">生日</li>
									<li class="input pl72 fn">
										<input name="birthday" type="date" style="width:70%; height: 44px;" class="textbox validate[required,maxSize[50]]" maxlength="20" value="{$member_info['birthday']}" placeholder="&nbsp;请填写生日" data-rel="" id="date_id"/></li>
								</ul>
							</eq>
							<eq name="area" value="1">
								<ul>
									<input type="hidden" value="1" name="area_"/>
									<li class="name w72">地区</li>
									<li class="input pl72">
										<select name="town_code" id="town_code" class="ml validate[required]">
											<option>选择县</option>
										</select>
										<select name="city_code" id="city_code" class="ml validate[required]">
											<option>选择市</option>
										</select>
										<select name="province_code" id="province_code" class="validate[required]">
											<option>选择省</option>
										</select>
									</li>
								</ul>
							</eq>


                		</div>
                            
                		<div class="item cj_items">
                            <volist name='memberCustomFieldInfo' id='customInfo'>
								<ul>
									<li class="name w100 tit">{$customInfo['text']}</li>
									<li class="input pl100 fn">
									<select name="{$customInfo['name']}">

										<if condition="$customInfo['value']">
											<else />
											<option value="">请选择</option>
										</if>
										 <volist name="customInfo.value_list" id="list">
                                          <option value="{$key}" data-txt="{$list}"
											 <if condition="$customInfo['value'] == $list">
												 selected
												 <else />
											 </if>
											 >{$list}</option>
                                         </volist>

									</select>
									</li>
								</ul>
                            </volist>
                        </div>
	                    <ul class="btn-ul">
	                    	<input type="hidden" id="sex" name="sex" value="" />
	                    	<input type="hidden" name="member_id" value="{$member_info.id}"	/>
                        	<li class="btn-li"><input type="button" value="保存" class="btn-up" /></li>
                    	</ul>
                	</form>
	            </div>
            </div>
        </div>
    </div>
</div>
<!--爱蒂宝-->
<include file="./Home/Tpl/Label/Store_adb.html"/>

</body>
</html>
<script>
    $(document).ready(function(e) {
	    // $(".Gform .clause label").eq(0).addClass("active");
		// $('.Gform .clause input').eq(0).attr("checked","checked");
		$(".sex1").click(function(){
	    	$(".sex2").removeClass("active");
	    	$(".sex1").addClass("active");
	    	$("#sex").val('2');

		});

		$(".sex2").click(function(){
	    	$(".sex1").removeClass("active");
	    	$(".sex2").addClass("active");
	    	$("#sex").val('1');
		});
    	
    	
    	CityCode({
			province:$("#province_code"),//省
			city:$("#city_code"),//市
			town:$("#town_code"),//区
			selected:"{:$member_info['province_code'].$member_info['city_code'].$member_info['town_code']}",//默认选中的省市区代号
			url:"{:U('LabelAdmin/AjaxCity/index')}"//数据查询页
		});

		$('.btn-up').click(function(){
			var sex = $('#sex').val();
			var town_code = $('#town_code').val();
			var city_code = $('#city_code').val();
			var province_code = $('#province_code').val();
			var node_id = "<?php echo $node_id;?>";
			var node_id = "{$node_id}";
			var checkzz = new RegExp("^[\u4E00-\u9FA5A-Za-z0-9_]+$");  
			var url = "{:U('Label/Member/index')}&node_id="+node_id;
			var name = $("#name").val();

			var pr=$("input[name=area_]").val();
			var na=$("input[name=name_]").val();
			if(na==1){
				if ( !checkzz.test($.trim(name))) {
					art.dialog({
						title:'提示',
						content:'姓名有误！只能为数字、汉子、下划线',
						width:'300px',
						height:'50px'
					});
					return false;
				}
			}

			if(pr==1){
				if ( town_code == '' || city_code == '' || province_code == '') {
					art.dialog({
						title:'提示',
						content:'城市不能为空',
						width:'300px',
						height:'50px'
					});
					return false;
				}
			}

	         art.dialog({
	             content: '<div style="width:100%;margin-left:110%;">是否修改？</div>',
	             padding:'0px',
	             width:'80px',
	             height:'50px',
	             title:'提示',
	             okVal: '确定',
	             fixed:true,
	             ok: function () {
	                 $.ajax({
	                    type: "POST",
	                    url:"{:U('Label/Member/savePersonal')}&node_id="+node_id,
	                    data:$('form').serialize(),
	                    success: function(result) {
	                        var d2 = art.dialog({content: '<div class="msg-all-error" style="width:60px;height:20px;">'+result+'</div>'});
	                        setTimeout(function () {
	                            d2.close();
	                            location.href = url;
	                        }, 1000); 
	                    }
	                 })
	             },  
	             cancelVal: '取消',
	             cancel: true
	         });
		});
    });
</script>