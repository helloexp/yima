<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>会员管理-招募活动创建-活动配置</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wnumgoods.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Waccount.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshopconfig.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wmember.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-2.1.1.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wcanal.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/jquery-ui.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/Wmember.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/json2.js?v=__VR__"></script>
<script>
$(function(){
	Gform();
	$('#save').click(function(){
		updata();
	});
})
</script>
<style>
.shopBoxFormCon{ margin-top:348px}
</style>
</head>
<body>
    <div id="wrapper"> 
        <include file="./Home/Tpl/Public/Public_header.html" />

        <div id="container" class="bgfff"> 
            <div id="main" class="rel">
            	<div class="member_con">
                	<div class="member_steps">
                    	<ul>
                        	<li class="past">基础信息</li>
                            <li class="current">活动配置</li>
                            <li>奖项设定</li>
                            <li>活动发布</li>
                            <li>发布成功</li>
                        </ul>
                    </div>
                	<div class="member_l">
                    	<div class="config_menu">
                        	<dl>
                            	<dt>可选的默认设置项</dt>
                                <dd data-add="2">姓名</dd>
                                <dd data-add="3">性别</dd>
                                <dd data-add="4">出生日期</dd>
                                <dd data-add="5">所在区域</dd>
                            </dl>
                        </div>
                    </div>
                    <div class="member_r" style="float:left; position:relative; padding-left:20px; padding-top:40px; width:880px;">
                    	<div class="shopBox fn">
							<div class="shopBoxCon">
								<div class="shopBoxCon-top"></div>
								<div class="cl"></div>
                                <div id="phoneCon" style='background: #f6f6f6 url("{$bg_pic}") no-repeat scroll 0 0 / 100% auto;'>
                                <div class="member_logo"><img src="{$log_img}"></div>
                                <div class="member_title">{$node_name}</div>
                                <div class="member_hd_name">{$act_name}</div>
                                <div  class="shopBoxView fn" style="background-image:none">
                                <form id="theform"  method="post">
                                    <div class="m-bind">
	                                    
                                    </div>
                                    <a class="m-btn" href="javascript:void(0);" id="sub_button">提&nbsp;&nbsp;交</a>
                                </form>
                                </div>
								</div>
								<div class="cl"></div>
                                <div class="shopBoxCon-bottom"><span></span></div>	
							</div>
							<div class="shopBoxForm">
								<div class="shopBoxFormCon">
									
								</div>
							</div>
						</div>
                        
                        <!-- <div class="member_hd_title tl">
                        <span>招募会员类别：<strong>会员</strong></span>
                        <span>下发电子会员卡：<label><input type="radio" name="has_memberCard"> 是</label><label class="ml10"><input type="radio" name="has_memberCard"> 否</label></span>
                        </div> -->
						<div class="fn tc pt20 mt20 mb20 Ginput">
							<input type="hidden" name="m_id" value="{$m_id}" id="m_id"/>
							<input type="hidden" name="isReEdit" value="{$isReEdit}" id="isReEdit"/>
                            <a href="javascript:void(0)" class="btn-all-del ml10">取消</a>
                            <eq name="isReEdit" value="0"><a href="{:U('Member/Member/setActBasicInfo',array('m_id' => $m_id, 'isReEdit' => 0))}" class="btn-all ml10">上一步</a></eq>
                            <a href="javascript:void(0)" class="btn-all ml10" id="save"><eq name="isReEdit" value="1">保存<else />下一步</eq></a>
						</div>
                    </div>
                </div>
            </div>
        </div>
		<include file="./Home/Tpl/Public/Public_footer.html" /> 
    </div>
    <div class="service"></div>
</body>
</html>
<present name="module">
<script>
var module = {$module};
var tempObj = {};
//判断初始化的时候应该把哪个必填的checkbox显示出来
var need = "";
$.each(module, function(x, obj){
	var name = obj.name;
	var id = getModId(obj.name);
	if (need == "" && name != "cellPhone") {
		need = id;
	}
	tempObj[name] = {"initialise": true, "id" : id, "is_neccessary" : obj.is_neccessary}
});
</script>
</present>
<script>
//type:1单选 2多选 3文本
//shopMod = $(".shopMod").length + 1;
toArray = "";
//list考虑以后自定义
data ={
		"module": <notpresent name="module">
		   		[{
		   			"cellPhone":{"initialise": true,"id":"1", "is_neccessary":"1"},
		   			"memberName": {"initialise": true,"id":"2", "is_neccessary":"1"},
		   			"gender":{"initialise": true,"id":"3", "is_neccessary":"1"},
		   			"birthday":{"initialise": true,"id":"4", "is_neccessary":"1"},
		   			"area":{"initialise": true,"id":"5", "is_neccessary":"1"},
		   			"list": []
		   		}]
		   		<else />
		   		[tempObj]
		   		</notpresent>
};

$(document).ready(function(e) {
    //可拖动的模块
    endMove();
	begin(data, need);
});
</script>
<script>
function endMove() {
	//预览
	$(".btn-all-del").click(function(){
		var datastr = updataJson();
		art.dialog.data('datastr', datastr[0]);
		art.dialog.data('title', $("[name='page_title']").val());
		art.dialog.open("{:U('Ecshop/Index/storepreview')}",{
			title:false,
			lock:true,
			fixed:true,
			width:"338px",
			height:"630px",
			ok:function(){
				art.dialog.close();
			}
		});
	})
}

function updata() {
	//todo
	//location.href = "{:U('Member/Member/setPrize')}";
    var returndata = updataJson();	
				
    //提交保存数据
    $.post("{:U('Member/Member/setPrize')}", {
        "json_data": returndata,
        "m_id":$('#m_id').val(),
        "isReEdit":$('#isReEdit').val()
    },
    function(data) {
        if (data.status) {
        	if ($('#isReEdit').val() == 1) {
        		window.location.href="{:U('Member/Member/recruit')}";
        	} else {
        		window.location.href="{:U('Member/Member/setPrize', array('m_id' => $m_id, 'isReEdit' => 0))}";
        	}
        } else {
            alert(data.msg);
        }
    },
    "json");
}
</script>

<script type="text/javascript">
Array.prototype.remove=function(dx){
	if(isNaN(dx)||dx>this.length){return false;}
	for(var i=0,n=0;i<this.length;i++){
		if(this[i]!=this[dx]){
			this[n++]=this[i]
		}
	}
	this.length-=1
}
</script>
<!--手机号-->
<script id="editcellPhone" type="text/html">
	
</script>
<!--artTemplate-->
<!--手机号-->
<script id="datacellPhone" type="text/html">
	{{if initialise}}
	<div class="shopMod member_hd_config" id="shopMod_{{id}}"  data-special="1">
		<div class="module-control"><span class="module-move"></span>
		</div>
		<div class="shopModBox-1 m-input">
				<p class="tit">*&nbsp; 手机号码：</p>
				<p class="cont"><input type="text" maxlength="20" class="input" ></p>
		</div>
	</div>
	{{/if}}
</script>
<!--姓名-->
<script id="datamemberName" type="text/html">
	{{if initialise}}
	<div class="shopMod Gform member_hd_config" id="shopMod_{{id}}" data-edit='{{id}}' data-special="2">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-2 m-input">
				<p class="tit">姓名：</p>
				<p class="cont"><input type="text" maxlength="20" class="input" ></p>
		</div>
	</div>
	{{/if}}
</script>

<!--性别-->
<script id="datagender" type="text/html">
	{{if initialise}}
	<div class="shopMod Gform member_hd_config" id="shopMod_{{id}}" data-edit='{{id}}' data-special="3">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-3 m-input">
			<p class="tit">性别</p>
			<nav class="segmented-control">
				<input type="radio" name="sc-2" id="sc-2-1"  />
				<input type="radio" name="sc-2" id="sc-2-2" checked="checked" />
				<label for="sc-2-1" data-value="男">男</label>
				<label for="sc-2-2" data-value="女">女</label>
			</nav>
		</div>
	</div>
	{{/if}}
</script>

<!--出生日期-->
<script id="databirthday" type="text/html">
	{{if initialise}}
	<div class="shopMod Gform member_hd_config" id="shopMod_{{id}}" data-edit='{{id}}' data-special="4">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-4 m-input">
			<p class="tit">出生日期</p>
			<p class="cont"><input type="text" class="input" id="org_number" name="org_number" placeholder="请输入您的生日" maxlength="15"></p>
		</div>
	</div>
	{{/if}}
</script>

<!--所在区域-->
<script id="dataarea" type="text/html">
	{{if initialise}}
	<div class="shopMod Gform member_hd_config" id="shopMod_{{id}}" data-edit='{{id}}' data-special="5">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-5 m-input">
			<p class="tit">所在区域</p>
			<p class="cont">
			<select name="province">
				<option value="">选择省</option>
			</select>
			<select name="city">
				<option value="">选择市</option>
			</select>
			</p>
		</div>
	</div>
	{{/if}}
</script>

<!--CheckBox-->
<script id="dataCheckBox" type="text/html">
	{{if initialise}}
	<div class="shopMod Gform member_hd_config" id="shopMod_{{id}}" data-edit='{{id}}' data-special="7">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-7">
			<ul>
				<li class="Gname">多选标题：</li>
				<li class="Ginput">
					<div class="switch auto hover  mt10 ml10 mb10">
						<input type="checkbox" name="a[]" value="1" checked="">
						<input type="checkbox" name="a[]" value="2">
						<input type="checkbox" name="a[]" value="3">
						<div class="newRadio">
							<span class="valfirst hover" data-val="1">选项1</span>
							<span data-val="2">选项2</span>
							<span data-val="3">选项3</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{ else }}
	<div class="shopMod" id="shopMod_{{id}}" data-edit='{{id}}' data-special="7">
		<div class="module-control"><span class="module-move"></span><span class="module-del"></span>
		</div>
		<div class="shopModBox-7">
			<ul>
				<li class="Ginput">
					<div class="switch auto hover  mt10 ml10 mb10">
						<input type="checkbox" name="a[]" value="1" checked="">
						<input type="checkbox" name="a[]" value="2">
						<input type="checkbox" name="a[]" value="3">
						<div class="newRadio">
							<span class="valfirst hover" data-val="1">选项1</span>
							<span data-val="2">选项2</span>
							<span data-val="3">选项3</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>
<!--============================编辑区域===================================================-->
<!--姓名-->
<script id="editmemberName" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="{{is_neccessary}}" checked="checked" name="memberName">
						<div class="newRadio" style="border:0">
							<span class="valfirst {{if is_neccessary==0}}hover{{/if}}" data-val="0">否</span>
							<span class="{{if is_neccessary==1}}hover{{/if}}" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

<!--性别-->
<script id="editgender" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="{{is_neccessary}}" checked="checked" name="gender">
						<div class="newRadio" style="border:0">
							<span class="valfirst {{if is_neccessary==0}}hover{{/if}}" data-val="0">否</span>
							<span class="{{if is_neccessary==1}}hover{{/if}}" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

<!--出生日期-->
<script id="editbirthday" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="{{is_neccessary}}" checked="checked" name="birthday">
						<div class="newRadio" style="border:0">
							<span class="valfirst {{if is_neccessary==0}}hover{{/if}}" data-val="0">否</span>
							<span class="{{if is_neccessary==1}}hover{{/if}}" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

<!--文本-->
<script id="editarea" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="{{is_neccessary}}" checked="checked" name="area">
						<div class="newRadio" style="border:0">
							<span class="valfirst {{if is_neccessary==0}}hover{{/if}}" data-val="0">否</span>
							<span class="{{if is_neccessary==1}}hover{{/if}}" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

<!--单选-->
<script id="editRadio" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="0" checked="checked">
						<div class="newRadio" style="border:0">
							<span class="valfirst hover" data-val="0">否</span>
							<span class="vallast" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
			<ul class="shopFormU mt10">
				<li class="shopFormN">单选标题：</li>
				<li class="shopFormI Ginput">
					<input type="text">
				</li>
			</ul>
			<ul class="shopFormU mt10">
				<li class="shopFormN">选项一：</li>
				<li class="shopFormI Ginput">
					<div class="Gadd" data-min="1" data-max="5">
						<input type="text" maxlength="20"><span class="maxTips forInput" data-max="20" style="right:0">0/20</span>
						<a href="javascript:void(0)" class="Gbtn-del" style="right:-64px;"><i></i></a>
					</div>
				</li>
			</ul>
			<ul class="shopFormU mt10">
				<li class="shopFormN">选项二：</li>
				<li class="shopFormI Ginput">
					<div class="Gadd" data-min="1" data-max="5">
						<input type="text" maxlength="20"><span class="maxTips forInput" data-max="20" style="right:0">0/20</span>
						<a href="javascript:void(0)" class="Gbtn-del" style="right:-64px;"><i></i></a>
					</div>
				</li>
			</ul>
			<ul class="shopFormU mt10">
				<li class="shopFormN">选项三：</li>
				<li class="shopFormI Ginput">
					<div class="Gadd" data-min="1" data-max="5">
						<input type="text" maxlength="20"><span class="maxTips forInput" data-max="20" style="right:0">0/20</span>
						<a href="javascript:void(0)" class="Gbtn-del" style="right:-64px;"><i></i></a>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{ else }}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI">
					<span><input type="radio" name="NameName" class="textbox" maxlength="20" value="{{Name}}" ><span class="maxTips forInput" data-max="20">必填</span>
					<span><input type="radio" name="NameName" class="textbox" maxlength="20" value="{{Name}}" ><span class="maxTips forInput" data-max="20">非必填</span>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

<!--多选-->
<script id="editCheckBox" type="text/html">
	{{if initialise}}
	<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
		<div class="shopForm Gform fn">
			<ul class="shopFormU">
				<li class="shopFormN">*&nbsp;是否必填：</li>
				<li class="shopFormI Ginput">
					<div class="switch">
						<input type="radio" value="0" checked="checked">
						<div class="newRadio" style="border:0">
							<span class="valfirst hover" data-val="0">否</span>
							<span class="vallast" data-val="1">是</span>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	{{/if}}
</script>

