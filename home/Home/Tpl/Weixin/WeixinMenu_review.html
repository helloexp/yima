<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>自定义菜单_营销渠道库_翼码旺财</title>
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wcanal.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/WX2.css?v=__VR__" rel="stylesheet" type="text/css" />
<css href="__PUBLIC__/Css/msg.css?v=__VR__" />
<js href="__PUBLIC__/Js/jquery-1.7.1.min.js?v=__VR__"/>
<js href="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"/>
<js href="__PUBLIC__/Js/check_form.js?v=__VR__"/>
<js href="__PUBLIC__/Js/Common.js?v=__VR__"/>
<js href="__PUBLIC__/Js/global.js?v=__VR__"/>
<js href="__PUBLIC__/Js/msg.js?v=__VR__"/>
<script type="text/javascript">
$(document).ready(function(e){
	msgNavList();

	<notempty name="initSet" value="1">
		//初始化 
		open_ajax_url("{:U('WeixinMenu/auth')}");
	</notempty>

});

function open_ajax_url(url){
var dialog = art.dialog({id: 'N3690',title: "授权设置",lock:true});
	// jQuery ajax   
	$.ajax({
		url: url,
		success: function (data) {
			dialog.content(data);
		},
		cache: false
	});
}

function do_public_wx(obj){
	var str = "发布成功将覆盖原有菜单配置，是否确认发布？";
	if(!confirm(str)) return false;
	dialog = art.dialog({title:false,lock:true});
	var href = $(obj).attr("href");
	$.get(href,'',function(d){
		dialog.close();
		if(d.status != '1'){
			if(d.info == 'AUTH_SET'){
				open_ajax_url("{:U('WeixinMenu/auth')}");
				return;
			}
			alert("操作失败："+d.info);
			
		}
		else{
			alert(d.info);
		}
	},'json');
	return false;
}
</script>
</head>
<body>
    <div id="wrapper" >
        <include file="./Home/Tpl/Public/Public_header.html" />
        <include file="./Home/Tpl/LabelAdmin/Channel_topMenu.html" topmenuid="gongzhonghao"/>
        <div id="container" >
            <div id="main" class="rel">
            	<!--<div class="bread">
                    <div class="bread-con fn">
                        <div class="bread-area">
                            <i class="icon-bread"></i>
                            <p><a href="{:U('Home/Index/index')}">首页</a></p>
                            <p>&gt;</p>
                            <p><a href="{:U('Home/Index/marketingShow')}">业务中心</a></p>
							<p>&gt;</p>
                            <p>微信助手</p>
                        </div>
                        <div class="bread-history">
                            <i class="icon-history"></i>
                            <p><a href="javascript:void(0)" class="ind-bread">返回</a></p>
                        </div>
                    </div>
                </div>-->
                <div class="sidenav">
                    <!--开始载入左菜单-->
					<include file="LabelAdmin/Batch/WleftMenu" leftmenuid="wxzs"/>
                </div>
                <div class="subcon">
                	<div class="main-name fn">
                        <!--<h4>高级渠道配置 - <A href="javascript:void(0);" class="btn-all w100 mt10" onclick="javascript:open_ajax_url('{:U('WeixinMenu/auth')}');">授权设置</A></h4>-->
                        <h4>自定义菜单</h4>
                    </div>

					<!--<div class="msg-nav-info">
						<p>1、公众帐号必须为服务号，且完成公众帐号在 旺财上的渠道配置； </p>
						<p>2、使用本模块，必须在微信公众平台》高级功能》开发者模式》会话界面自定义菜单 》点击“申请”，并完成申请后，获得“接口配置信息”中的AppId和AppSecret； </p>
						<p>3、在自定义菜单配置页面点击【授权设置】，完成AppId和AppSecret绑定； </p>
						<p>4、一级菜单数量必须为<span>3个</span>，每个一级菜单下最多可以创建<span>5个</span>二级菜单； </p>
						<p>5、完成菜单配置后，点击<span>【发布】</span>，后台将覆盖更新微信公众帐号原自定义菜单；</p> 
						<p>6、拖动树形菜单再点击“保存排序”可以对菜单重排序，但最终只有“发布”后才会生效。</p> 
						<p>7、公众平台限制菜单更新最高100次/天。 </p>
						<p>8、 微信自定义菜单支持点击后返回图文、文本信息或 点击后直接跳转到wap页面两种交互。</p> 
						<p>9、创建自定义菜单后，由于微信客户端缓存，需要24小时微信客户端才会展现出来。建议测试时可以尝试取消关注公众账号后，再次关注，则可以看到创建后的效果。</p>

                    </div>-->
                    <div class="highlight_box icon_wrap icon_small border">
                    <div class="opr"><a href="javascript:;" class="btn btn_warn">停用</a></div>        
                    <span class="icon unlock"></span>
                    <h4 class="title">已开启自定义菜单</h4>
                    <p class="desc">通过编辑和发布自定义菜单来进行便携管理，如具备开发能力，可更灵活地使用该功能。查看详情 <a href="javascript:;" class="detail_desc">查看详情</a></p>    
                    </div>
                    
                    <div class="msg-nav fn">
                    <p class="menu_setting_tips">可创建最多3个一级菜单，每个一级菜单下可创建最多5个二级菜单。</p>
                    	<div class="msg-nav-list">
                        	<ul class="msg-nav-list-all">
                            	<li>
                                    <div class="msg-nav-listEdit">
                                    	<i class="icon-msg-sort" title="菜单排序"><a href="{:U('WeixinMenu/menuSort',array('level'=>1))}" target="msgNavIframe" class="a-hide"></a></i>
                                        <i class="icon-msg-plus add-oneList" title="添加一级子菜单"><a href="{:U('WeixinMenu/add',array('level'=>1))}" target="msgNavIframe" class="a-hide"></a></i>
                                    </div>
                                	<a href="javascript:void(0)">菜单管理</a>
                                </li>
                            </ul>
							<volist name="menuArr" id="v">
                            <div class="msg-nav-list-item">
                                <ul class="msg-nav-list-one">
                                    <li>
                                        <div class="msg-nav-listEdit">
                                            <a href="{:U('WeixinMenu/delete',array('id'=>$v['id']))}" onclick="return confirm_ajax_link(this);" class="del"><i class="icon-msg-remove" title="删除菜单(其下没有子菜单才可以删除)"></i></a>
                                            <a href="{:U('WeixinMenu/add',array('level'=>2,'parent_id'=>$v['id']))}" target="msgNavIframe" class="add"><i class="icon-msg-plus" title="添加二级子菜单"></i></a>
                                        </div>
                                        <a href="{:U('WeixinMenu/edit',array('level'=>1,'id'=>$v['id']))}" target="msgNavIframe">{$v.title}</a>
                                    </li>
                                </ul>
								
                                <ul class="msg-nav-list-two">
								 <volist name="v['sub_menu']" id="v2">
                                    <li>
                                        <div class="msg-nav-listEdit">
                                            <a href="{:U('WeixinMenu/delete',array('id'=>$v2['id']))}" onclick="return confirm_ajax_link(this);"><i class="icon-msg-remove" title="删除菜单(其下没有子菜单才可以删除)"></i></a>
                                        </div>
                                        <a href="{:U('WeixinMenu/edit',array('level'=>2,'id'=>$v2['id']))}" target="msgNavIframe"> - {$v2.title}</a>
                                    </li>
                                 </volist>
                                </ul>
                            </div>
							</volist>
                           <div class="msg-nav-list-updata"> 
							<a href="{:U('WeixinMenu/publicWx')}" title="发布" class="btn-all w50 mt10" onclick="return do_public_wx(this)">发布</a> 
							<a href="{:U('WeixinMenu/stopWx')}"  title="停用" class="btn-all-del w50 ml10 mt10" onclick="return do_public_wx(this)">停用</a> 
						   </div>
                        </div>
                        <div class="msg-nav-con">
                            <div class="msg-nav-con-iframe">
                            	<iframe marginheight="0" marginwidth="0" frameborder="0" src="{:U('WeixinMenu/menuSort')}" name="msgNavIframe" width="100%" height="600" scrolling="auto" frameborder="0"></iframe>
                            </div>
                        </div>
                    </div>

					

                </div>
            </div>
        </div>
        <include file="./Home/Tpl/Public/Public_footer.html" />
    </div>
    <div class="service"></div>
</body>
</html>