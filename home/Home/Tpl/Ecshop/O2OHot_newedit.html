<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>操作平台_{:C('SITE_TITLE')}</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.8.2.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC_LOCAL__/Js/My97DatePicker/WdatePicker.js?v=__VR__"></script>
<js href="__PUBLIC__/Js/validationEngine/languages/jquery.validationEngine-zh_CN.js?v=__VR__" />
<js href="__PUBLIC__/Js/validationEngine/jquery.validationEngine.js?v=__VR__" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/ajaxfileupload.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/jquery-ui.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
</head>
<body>
    <div id="wrapper">
    	<include file="./Home/Tpl/Public/Public_header.html" />  
        <include file="Shop/nav" navmenuid="Navhot"/>
        
        <div id="container" class="bgfff">
            <div id="main" class="rel">
                <div class="sidenav">
                    <!--开始引入左菜单-->
                    <assign name="leftMenuId" value="1"/>
                    <include file="Hot/menu" hotmenuid="msm_xptj"/>
                </div>
                <div class="subcon fn">
                	<div class="main-name fn">
                        <h4>新品发售</h4>
                    </div>
                    <div class="shopBox fn">
                    	<div class="shopBoxCon nobottom">
                        	<div class="shopBoxCon-top"></div>
                        	<div class="shopBoxCon-title" id="shopMod_0" data-edit='0'><span>新品发售</span></div>
                            <div class="cl"></div>
                        	<div class="shopBoxView nopadding fn">
                            	
                            </div>

                        </div>
                    	<div class="shopBoxForm">
							<!--[if IE]><div class="IEmsgerro">您的浏览器无法使用该模块功能,请使用<span>Chrome谷歌浏览器</span>或切换至<span>极速模式</span>/<span>高速模式</span>进行操作</div><![endif]-->
                        	<div class="shopBoxFormCon">
							<form action="{:U('Ecshop/MaShangMai/editNewSubmit')}" method="POST" name="theform" id="theform" enctype="multipart/form-data">
							 <input type="hidden" name="id" value="<?php echo $row['id']; ?>" />
							  <input type="hidden" name="new_id" value="<?php echo $pageInfo['id']; ?>" />
							  <input type="hidden" name="node_name" value="<?php echo $node_name; ?>" />

                            	<!--页面-->
                                <div class="editshopBoxForm shopBoxForm-0"data-id="shopMod_0">
                                	<div class="shopForm fn">
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;活动名称：</li>
                                            <li class="shopFormI">
                                                <input name="name" id="name" type="text" class="validate[required,optional,maxSize[20]] textbox" maxlength="8" value="{$row.name}"><span class="maxTips forInput" data-max="8">0/8</span>
                                                <span class="txtTips">活动名称</span>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;活动时间：</li>
                                            <li class="shopFormI">
                                                <div class="inputTime2 fn">
                                                	<input name="start_time" id="start_time" type="text" class="validate[required] textbox textbox1" maxlength="8"  onclick="WdatePicker({maxDate:'#F{$dp.$D(\\'end_time\\')}'})" value="<?php echo date('Ymd',strtotime($row['start_time']));?>">
                                                    <em>至</em>
                                                	<input name="end_time"  id="end_time" type="text" class="validate[required] textbox textbox2" maxlength="8" onclick="WdatePicker({minDate:'#F{$dp.$D(\\'start_time\\')}'})" value="<?php echo date('Ymd',strtotime($row['end_time']));?>">
                                                </div>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;选择商品：</li>
                                            <li class="shopFormI">
                                            	<span class="spanname"><?php echo $row['goods_name']; ?></span>
                                                <input type="hidden" name="select_goods_id" id="select_goods_id" value="<?php echo $row['goods_id']; ?>"/>
                                                <input type="hidden" name="select_goods_limit" id="select_goods_limit" value="{$row['remain_num']}"/>
                                            </li>
                                        </ul>                            
                                        <ul class="shopFormU not_skuinfos">
                                            <li class="shopFormN">*&nbsp;商品销售价格：</li>
                                            <li class="shopFormI">
                                            	<input name="group_price" id="group_price" type="text" class="validate[custom[number],min[0],required,maxSize[10]] textbox" maxlength="8" value="<?php echo $row['group_price'];?>"><span class="maxTips forInput">元</span>
                                            </li>
                                        </ul>
                                        <div>
                                            <ul class="shopFormU sku_infos" style="display:none;">
                                                <li class="shopFormN">*&nbsp;商品销售规格：</li>
                                                <li class="shopFormI">&nbsp;</li>
                                            </ul>
                                            <ul class="shopFormU">
                                                <li class="shopFormI noName">
                                                    <div class="skuTable"></div>
                                                </li>
                                            </ul>
										 <ul class="shopFormU not_skuinfos">
                                            <li class="shopFormN">*&nbsp;商品销售总数：</li>
                                            <li class="shopFormI">
                                            	<div class="switch <?php if($row['storage_num']!='-1'){ ?>hover<?php }?> <?php if(($row['storage_type']=='0' && $row['storage_num']=='-1') || ($row['storage_type']!='0' && $row['storage_num']!='-1')){?>disabled<?php }?>">
                                                	<input type="radio" name="goods_num_limit" id="goods_num_limit" value="<?php if($row['storage_num']=='-1'){ ?>1<?php }else{ ?>0<?php }?>" checked="checked">
                                                	<div class="newRadio"><i></i><span class="value1" data-rel="1">不限制</span><span class="value2" data-rel="0">限制</span></div>
                                                    <div class="newRadio-input">
                                            		<input name="goods_num" id="goods_num" type="text" class="validate[condRequired[goods_num_limit]] textbox ml10" maxlength="8" <if condition="$row['storage_num'] neq -1">value="{$row['storage_num']}"</if> style="width:172px;"><span class="maxTips forInput">份</span>
                                                    </div>
                                                </div>
												<div class="cl"></div>
                                                <span class="txtTips dn"></span>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU not_skuinfos">
                                            <li class="shopFormN">*&nbsp;商品市场价格：</li>
                                            <li class="shopFormI">
                                            	<div class="switch <?php if($row['market_price']!='0'){ ?>hover<?php }?>">
                                                	<input type="radio" name="market_price_flag" id="market_price_flag" value="<?php if($row['market_price']==0){?>0<?php }else{?>1<?php }?>" checked="checked">
                                                	<div class="newRadio"><i></i><span class="value1" data-rel="0">不显示</span><span class="value2" data-rel="1">显示</span></div>
                                                    <div class="newRadio-input">
                                            		<input name="market_price" id="market_price" type="text" class="validate[condRequired[market_price_flag]] textbox ml10" maxlength="8" <if condition="$row['market_price'] neq 0">value="{$row['market_price']}"</if> style="width:172px;"><span class="maxTips forInput">元</span>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;每日限购量：</li>
                                            <li class="shopFormI">
                                            	<div class="switch <?php if($row['buy_num']!='0'){ ?>hover<?php }?>">
                                                	<input type="radio" name="buy_num_flag" id="buy_num_flag" value="<?php if($row['buy_num']==0){?>0<?php }else{?>1<?php }?>" checked="checked">
                                                	<div class="newRadio"><i></i><span class="value1" data-rel="0">不限制</span><span class="value2" data-rel="1">限制</span></div>
                                                    <div class="newRadio-input">
                                            		<input name="buy_num" id="buy_num" type="text" class="validate[condRequired[buy_num_flag]] textbox ml10" maxlength="8" <if condition="$row['buy_num'] neq 0"> value="{$row['buy_num']}"</if> style="width:172px;"><span class="maxTips forInput">份</span>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;个人限购量：</li>
                                            <li class="shopFormI">
                                            	<div class="switch <?php if($row['defined_three_name']>=0){ ?>hover<?php }?>">
                                                	<input type="radio" name="buy_num_user" id="buy_num_user" value="<?php if($row['defined_three_name']<0){?>0<?php }else{ ?>1<?php }?>" checked="checked">
                                                	<div class="newRadio"><i></i><span class="value1" data-rel="0">不限制</span><span class="value2" data-rel="1">限制</span></div>
                                                    <div class="newRadio-input">
                                            		<input name="buy_cont" type="text" class="validate[condRequired[buy_num_user]] textbox ml10" maxlength="8" <if condition="$row['defined_three_name'] egt 0"> value="{$row['defined_three_name']}" </if> style="width:172px;"><span class="maxTips forInput">份</span>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
										<ul class="shopFormU">
                                            <li class="shopFormN">参与红包优惠：</li>
                                            <li class="shopFormI">
                                                <label><input name="bonus_flag" type="radio" <eq name="row.bonus_flag" value="1">checked="checked"</eq> value="1">是</label>
                                                <label><input name="bonus_flag" type="radio" <eq name="row.bonus_flag" value="0">checked="checked"</eq> value="0">否</label>
												<div class="cl"></div>
                                                <span class="txtTips" style="width:350px;">选择参与红包优惠，则消费者在线购买此商品时，可以使用红包抵用支付金额</span>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                                <li class="shopFormN">支持积分支付：</li>
                                                <li class="shopFormI">
                                                    <label><input type="radio" name="integral_flag" <eq name="row.integral_flag" value="1">checked="checked"</eq> value="1" <if condition="$isIntergral neq true">disabled</if> >是</label>
                                                    <label><input type="radio" name="integral_flag" value="0" <eq name="row.integral_flag" value="0">checked="checked"</eq> <if condition="$isIntergral neq true">disabled</if> >否</label>
                                                    <div class="cl"></div>
                                                    <if condition="$isIntergral eq true"><span class="txtTips" style="width:350px;">选择支持积分支付，此商品即允许消费者使用积分来购买；<a href="{:U('Integral/Integral/integralRuleList/')}" target="_blank">点击查看积分支付规则</a></span></if>
                                                    <if condition="$isIntergral neq true"><span class="txtTips" style="width:350px;" >您尚未开启积分支付功能，<a href="{:U('Integral/Integral/integralRuleList/')}" target="_blank">点击立即开通</a></span></if>
                                                </li>
                                        </ul>    
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;购买对象限制：</li>
                                            <li class="shopFormI">
                                            	<label onClick="$('#wxlink').hide();"><input type="radio" value="0" name="member_join_flag" id="mem_join_no" class="checkradio" <eq name="row.member_join_flag" value="0">checked="checked"</eq> />不限</label>&nbsp;&nbsp;
                                                <label><input type="radio" value="1" name="member_join_flag" id="mem_join" <eq name="row.member_join_flag" value="1">checked="checked"</eq> />微信粉丝</label>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU <eq name="row.member_join_flag" value="0">dn</eq>" id="wxlink">
                                            <li class="shopFormN">*&nbsp;引导页链接：</li>
                                            <li class="shopFormI">
                                            	<input class="textbox" name="fans_collect_url" id="fans_collect_url" type="text" value="{$row['fans_collect_url']}" placeholder="请输入带http://的地址" />
                                                <p class="txtTips">当消费者不是您微信公众号粉丝时，将引导消费者打开您设置的“引导关注页”。<a href="http://www.wangcaio2o.com/index.php?g=Home&m=Help&a=helpArt&news_id=1333&leftId=zxwt&class_name=%E6%9C%80%E6%96%B0%E9%97%AE%E9%A2%98&type=1" target="_blank">如何设置？</a></p>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">*&nbsp;是否配送：</li>
                                            <li class="shopFormI">
                                                <?php if($row['goods_type'] != '6'){?>
                                                        <label id="delivery_status1" class="ml20">自提</label>
                                                <?php }else{?>
                                                <?php
                                                        if($row['defined_one_name'] != null)
                                                                $d_array = explode('-',$row['defined_one_name']);
                                                        if('2' != $isCycle){
                                                ?>
                                                <label id="delivery_flag1_label"><input name="delivery_flag[]" type="checkbox" value="0"  <?php if(in_array('0',$d_array)){?> checked="checked" <?php }?> class="validate[required]">消费者自提</label>
                                                <label><input name="delivery_flag[]" id="delivery_flag2" type="checkbox" value="1" <?php if(in_array('1',$d_array)){?> checked="checked" <?php }?> class="validate[required]">物流配送</label>
                                                <?php }else{ ?>
                                                <p class="span l">
                                                        <label class="ml20"><input type="hidden" name="delivery_flag" value="1"  />仅支持物流配送</label>
                                                </p>
                                                <?php
                                                    }
                                                } ?>					
                                                <div class="cl"></div>
                                                <div class="shopFormMore fn erro <?php if(!in_array('0',$d_array)){?>dn<?php }?>">
                                                短信内容：<textarea maxlength="40" name="cusMsg" id="cusMsg" style="width:318px;"   class="validate[required,maxSize[40]] Gview-cusMsg showSendtype cusMsg dn" placeholder="您收到哈根达斯100元代金券">{$row['sms_text']}</textarea>
                                                    <div class="cl pt10"></div>
                                                    <p>*商品使用说明:&nbsp;&nbsp;<textarea name="using_rules" id="using_rules" class="validate[required] textbox"><?php echo $row['use_rule'];?></textarea><br />使用说明将显示在短信详情页面
                                                    <div class="cl pt10"></div>
                                                    <p>支持送礼:&nbsp;&nbsp;
                                                       <label class="ml10" style="float:none;">
                                                           <input type="radio" value="0" name="send_gift" class="checkradio" <eq name="sendGift" value='0'>checked="checked"</eq> />否
                                                       </label>
                                                       <label class="ml10" style="float:none;">
                                                           <input type="radio" value="1" name="send_gift" id="send_gift" <eq name="sendGift" value='1'>checked="checked"</eq> class="checkradio" />是
                                                       </label>
                                                    </p>
                                                    <div class="cl pt10"></div>
                                                    <p>*商品过期:
                                                            <label class="ml10" style="float:none;">
                                                            <input type="radio"  name="verify_time_type"   <if condition="$row['verify_end_type'] eq '0'">checked="checked"</if> value="0" id="verify_begin_type1"><span class="ml5">按日期</span></label>
                                                            <label style="float:none;">
                                                            <input type="radio" name="verify_time_type" value="1"  <if condition="$row['verify_end_type'] eq '1'">checked="checked"</if> id="verify_begin_type2"><span class="ml5">按天数</span></label>
                                                    </p>
                                                    <div class="cl pt5"></div>
                                                    <div class="inputTime1 judgeCon-time1" style="margin-left:74px;">
                                                        <input name="verify_end_date" type="text" id="verify_end_date" onclick="WdatePicker({minDate:'#F{$dp.$D(\\'verify_end_date\\')}'})" class="validate[condRequired[verify_begin_type1]] textbox" maxlength="10" value="<?php echo dateformat($row['verify_end_date'],'Ymd')?>" style="width:182px;"><em></em>
                                                    </div>
                                                    <div class="inputTime1 day judgeCon-time2" style="margin-left:74px; display:none;">
                                                        <input name="verify_end_days"  id="verify_end_days" type="text" class="validate[custom[integer],min[0],condRequired[verify_begin_type2]] textbox" maxlength="10" value="{$row['verify_end_date']}" style="width:48px;"><em></em>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        <eq name="isCycle" value="1">    
					<ul class="shopFormU" id="isSendPay">
                                            <li class="shopFormN">支持货到付款：</li>
                                            <li class="shopFormI">
                                                <label><input name="deli_pay_flag" type="radio" <eq name="row.deli_pay_flag" value="0">checked="checked"</eq> value="0">否</label>
                                                <label><input name="deli_pay_flag" type="radio" <eq name="row.deli_pay_flag" value="1">checked="checked"</eq> value="1">是</label>
                                            </li>
                                        </ul>
                                        </eq>      
                                        <ul class="shopFormU">
                                            <li class="shopFormN">加入码上买列表：</li>
                                            <li class="shopFormI">
                                                <label><input name="show_flag" type="radio" <if condition="$row['defined_two_name'] eq 0" >checked="checked"</if> value="0">否</label>
                                                <label><input name="show_flag" type="radio" <if condition="$row['defined_two_name'] neq 0" >checked="checked"</if>  value="1">是</label>
                                                <div class="cl"></div>
                                                <span class="txtTips" style="width:350px;">选择【是】，您的活动将显示在旺财创建的码上买活动列表中，消费者在任一码上买活动页面均可浏览您的活动列表。<span style="color:#ff0000;">请确保您的测试类活动不要勾选此选项，以避免消费者下单购买您的测试商品而产生纠纷</span></span>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">&nbsp;商品简介：</li>
                                            <li class="shopFormI">
                                                <textarea name="goods_memo" id="goods_memo" class="textbox" maxlength="200">{$row['memo']}</textarea><span class="maxTips forArea" data-max="20">0/200</span>
                                               
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">&nbsp;分享图片：</li>
                                            <li class="shopFormI">
                                            	<a href="javascript:void(0)" class="btn-up btn-upIcon vm" id="share_pic_btn">选择图片</a>
                                                <input type="hidden" value="" name="data_price_info" id="data_price_info" />
                                                <input type="hidden" value="{$isSku}" name="is_sku" id="is_sku" />
                                                <input type="hidden" value="" name="count_num" id="count_num" />
                                                <input type="hidden" name="share_pic" id="share_pic" class="share_pic_val" value="{$row['share_pic']}">
												<?php
												if($row['share_pic']!=""){
												?>
												<img name="img" id="share_pic_show" src="<?php echo get_upload_url($row['share_pic']);?>" width="28" height="28" class="vm ml10 share_pic_show" />
												<?php
												}else{
												?>
												<img name="img" id="share_pic_show" src="" width="28" height="28" class="vm ml10 dn share_pic_show" />
												<?php
												}
												?>
                                                <span class="txtTips">建议大小:50*50px;用户通过微信分享时，显示图片</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
								</form>
                            	<!--页面-->
                            </div>
                        </div>
                    </div>
						<div class="cl"></div>
						<div class="fn tl pt10">
							<a href="javascript:void(0)" class="btn-all ml30 w110" id="sub_button">保存</a>
							<a href="javascript:void(0)" class="btn-all-del ml20 w110">预览</a>
						</div>

                </div>
            </div>
        </div>
		<include file="./Home/Tpl/Public/Public_footer.html" /> 
    </div>
    <div class="service"></div>
</body>
</html>
<script>
$(".shopBoxCon-title").click();
shopMod = $(".shopMod").length+1 ;
toArray = "" ;
data="";
checkRadiuslength = $(".sortableHotRecommend").find(".shopFormBanner").length;
data = {$pageInfo.page_content};
var isopencusMsg = "{$startUp}"; //1：设置了短信内容自定义 0：未设置自定义
$(document).ready(function(e){
    if(isopencusMsg==1){
        $(".nocusMsg").hide();
        $(".cusMsg").show();
    }else{
        $(".nocusMsg").show();
        $(".cusMsg").hide();
    }
	//可拖动的模块
    endMove();
    if(data!=""){	
		begin(data);
	};
	//微信粉丝专享
	$('#mem_join').click(function(){
		$.post(
			"{:U('Ecshop/GoodsPutOn/checkwxyx')}",
			{id:1},
			function (data) {
				if(data.status==1){
					art.dialog({
						id:"msgcheck",
						title:"微信公众号参与提醒",
						content:'<p style="color:#333; line-height:25px; font-size:14px;padding-bottom:10px;">请确认您“微信助手”中配置的账户信息有效，否则将导致消费者无法购买该商品。</p><p style="color:#333; line-height:25px; font-size:14px;"><label class="vm"><input type="checkbox" class="vm" name="wxcheckbox"><span class="vm ml5">我确认“微信助手”设置的微信公众号账户有效</span></label></p>',
						fixed: true,
						width:400,
						icon: 'warning',
						lock:true,
						okVal: '确认',
						ok: function () {
							if(!$("input[name='wxcheckbox']").attr("checked")){
								return false
							}else{
								$('#wxlink').show();
							}
						},
						cancel:function () {
							$('#wxlink').hide();
						$('#mem_join_no').attr('checked',true);
						}
					});
				}else{
					$('#mem_join_no').attr('checked',true);
					$('#wxlink').hide();
					art.dialog({
						title: '微信公众号参与提醒',
						icon: 'warning',
						content:"亲，由于本功能需要<font color='red'><b>微信服务号</b></font>参与，<br />请在“微信助手”中绑定您的<font color='red'><b>微信服务号</b></font>。",
						lock:true,
						okVal:"去设置",
						ok:function(){
							//window.location.href = "{:U('Weixin/Weixin/index')}";
							window.open("{:U('Weixin/Weixin/index')}",'_blank');
						},
						 cancelVal:'关闭',
						 cancel: true
					});
					return false;
				}
			},
			'json'
		);
	});
	//爆款销售单独
	$("[name^='delivery_flag'][value='0']").change(function(){
		var check = $(this).prop("checked") ? $(this).prop("checked") : false ;
		if(check){
            // var length_nums = 0;
            // if($("#using_rules").attr("lenght_nums") == undefined)
            //     $("#using_rules").attr("lenght_nums",100);
              
            // length_nums = parseInt($('#using_rules').attr('lenght_nums')) - parseInt($('#name').val().length);
            // $('#using_rules').attr('class','validate[required,maxSize['+length_nums+'] textbox');
            // $('#using_rules').attr('maxlength',length_nums);
            // $('#using_rules_text').attr('data-max', length_nums);
            // $('#using_rules_text').html('0/'+length_nums);
			$(this).closest(".shopFormI").find(".shopFormMore").show();
		}else{
			$(this).closest(".shopFormI").find(".shopFormMore").hide();
		}
	});
        $('#delivery_flag2').change(function(){
            if(!this.checked){
                $('#isSendPay').hide();
            }else{
                $('#isSendPay').show();
            }
        });
        if($('#delivery_flag2').attr('checked') == 'checked'){
            $('#isSendPay').show();
        }else{
            $('#isSendPay').hide();
        }
	$("[name^='verify_time_type']").change(function(){
		var check = $(this).val();
		if(check==0){
			$(this).closest(".shopFormMore").find(".judgeCon-time2").hide();
			$(this).closest(".shopFormMore").find(".judgeCon-time1").show();
		}else{
			$(this).closest(".shopFormMore").find(".judgeCon-time1").hide();
			$(this).closest(".shopFormMore").find(".judgeCon-time2").show();
		}
	});
	$(".switch").click(function(){
		if($(this).hasClass("disabled")){return false;}
		if($(this).hasClass("hover")){
			$(this).removeClass("hover");
			$(this).find("input[type='radio']").val($(this).find(".value1").attr("data-rel"));			
			$(this).find("input[type='text']").val("");
		}else{
			$(this).addClass("hover");
			$(this).find("input[type='radio']").val($(this).find(".value2").attr("data-rel"));
		};
	})
	$(".switch input").click(function(){
		event.stopPropagation();
	})
	$("#music").change(function(){
		$(this).prev("a").find("label").text($(this).val());
	})

	$(".shopModFlashDiv li div h3").each(function(){
		var _this = $(this);
		_this.html(_this.text());
	});
	$("[name^='BannerDescription']").each(function(){
		var _this = $(this);
		var _thisVal = _this.val();
			_thisVal = _thisVal.replace(/<br>/g,"\n");
		_this.val(_thisVal);
	});
	$(".shopModFlashDiv li div.radio").each(function(){
		var _thisFlashDiv = $(this);
		var textHeight = parseInt(_thisFlashDiv.width());
		_thisFlashDiv.css("height",textHeight);
	});
	$(".shopModFlashDiv li div.checkPositionX").each(function(){
		var _thisFlashDiv = $(this);
		var textWidth = parseInt(_thisFlashDiv.width());
		_thisFlashDiv.css("margin-top",-textWidth);
	});
	$(".shopModFlashDiv li div.checkPositionY").each(function(){
		var _thisFlashDiv = $(this);
		var textHeight = parseInt(_thisFlashDiv.height());
		_thisFlashDiv.css("margin-top",-textHeight);
	});

	//提交表单
	$('#sub_button').click(function(){
		$(".shopBoxCon-title").click();	  
		if($("#theform").validationEngine('validate')){
			//判断其他校验
			var goods_num_limit=$("#goods_num_limit").val();
			var market_price_flag=$("#market_price_flag").val();
			var buy_num_flag=$("#buy_num_flag").val();
			var buy_num_user=$("#buy_num_user").val();
			var returndata = updataJson();	
				if(returndata[0]==""){
					alert("出错了，提交数据为空！");	
				}
                        
                         //取得sku价格表
                        var sellprice = [];
                        $(".skuTable [name='sellprice']").each(function(index, element) {
                            var p = $(this).val();
                                        var nid = $(this).attr("data-id");
                            var n = $(this).closest("tr").find("[name='sku_storag']").val();
                            var sp = $(this).closest("tr").find("[name='sellprice']").val();
                                        var arr = {
                                                newid:nid,
                                                price:sp,
                                                num:n
                                        };
                                        sellprice.push(arr);
                        });
                        skudata["price"] = sellprice;
                        $('#data_price_info').val(JSON.stringify( skudata.price ));
			var datastr=returndata[0];
			$("#theform").ajaxSubmit({
				beforeSubmit:function(){
					dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",fixed: true,padding:0});
				},
				success:function(data){
				 if(data.status == '1'){
					 all_art_close();
					  //提交模板入库
					 $.post("{:U('Ecshop/O2OHot/newpageSubmit')}", {
						"datastr":datastr,
						"m_id":data.m_id,
						"new_id":data.new_id
					},
					function(data) {
						if (data.status == 0) {
							alert(data.msg);
							window.location.href="index.php?g=Ecshop&m=O2OHot&a=index&is_new=2";
						} else {
							alert(data.msg);
						}
					},
					"json");
					return false;
				  }else{
					   dialog.time(5).content("<div class='msg-all-error'>"+data.info+"</div>");
				  }
			},
				dataType:'json'
			});
			return false;
		}
	});

	//轮播图片
	$(".shopBoxFormCon").on("click", ".img",function() {
		var opt = {obj:$(this),type:"upBannerImg",width:640,height:1010,callback:'EditImg'};
			open_img_uploader(opt);
	});

	//分享图片
	$("#share_pic_btn").click(function(){       
		var opt = {obj:$(this),type:"upShare",width:100,height:100,callback:'EditImg'};
			open_img_uploader(opt);
	});
	//音乐
	$(".shopBoxFormCon").on("click", ".Gbtn-music",function(){
		var opt = {
				obj:$(this),
				inputname:'resp_music',
				callback:function(options){
					$(".btn-upMusic").text(options.savename);
					$(".btn-upMusic").attr("href",options.src);
					$("#resp_music").val(options.src);
				}
			};
		open_music_uploader(opt);
	});

	//预览
	$(".btn-all-del").click(function(){
		var datastr = updataJson();
		art.dialog.data('datastr', datastr[0]);
		art.dialog.data('title', $("[name='page_title']").val());
		art.dialog.open("{:U('Ecshop/Index/storepreview')}",{
			title:false,
			lock:true,
			fixed:true,
			width:"338px",
			height:"630px",
			ok:function(){
				art.dialog.close();
			}
		});
	})

	$('#bind_marketgoods,#bind_goods').click(function(){
		var url = '', title = '';
		if(this.id == 'bind_marketgoods'){
			url = '{:U('Common/SelectJp/index',array('callback'=>'cb_setGoodsInfo','for'=>'ecshop'))}';
			title = '选择卡券';
		}else{
			url = '{:U('Common/SelectJp/index',array('goods_type'=>'6','callback'=>'cb_setGoodsInfo'))}';
			title = '选择商品';
		}
		art.dialog.open(url,{
			width: 800,
			height: 600,
			title: title,
			lock: true,
			id: 'selectjp'
		})
	});
});

$(window).scroll(function(){
	var serviceTop = $(window).scrollTop();
	window.nowTop = $(window).scrollTop();
	if (serviceTop>190 && window.nowTop > window.preTop){
		if(parseInt($(".shopBox").height())>parseInt($(".shopBoxForm").height())){
			window.preTop = window.nowTop;
			return false;
		}else{
			$(".shopBoxCon").css("margin-top",serviceTop-190);
			window.preTop = window.nowTop;
		}
	}else if (serviceTop>190 && window.nowTop < window.preTop){
			$(".shopBoxCon").css("margin-top",serviceTop-190);
			window.preTop = window.nowTop;
	}else{
		$(".shopBoxCon").css("margin-top",0);
		window.preTop = window.nowTop;
	}
});

</script>
<script type="text/javascript" src="__PUBLIC__/Js/Wshop.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Label/Js/idangerous.swiper.min.js"></script>
<script>
var Hotrecommendt = "";
$(document).ready(function(e){
	Hotrecommendt = new Swiper('.shopModFlashDiv',{
		pagination: 'dl',
		paginationClickable: true,
		slideElement:"li",
		mode: "vertical"
	})
});
</script>
<script>
function endMove() {
    //多个商品选择
    $(".shopBoxFormCon").on("click", ".btn-upPro",
    function() {
        var url = "/index.php?g=Ecshop&m=GoodsPutOn&a=SelectRgoods&cb_init=cb_rgoodsinit&cb_rgoodsadd=cb_rgoodsadd&cb_rgoodsdel=cb_rgoodsdel";
        var _this = $(this);
        art.dialog.data('_this', _this);
        art.dialog.open(url, {
            width: 800,
            height: 500,
            title: '选择商品',
            lock: true,
            id: 'selectjp'
        });
    });
}

//选择商品/卡券回调函数
function cb_setGoodsInfo(data){
    _goods_info = data;
    art.dialog.list['selectjp'].close();
	$('#select_goods_id').val(data.id);
   // $('#goods_memo').val(data.goods_desc);
	$('#market_price').val(data.market_price);
    $('#mms_title').val(data.mms_title);
    $('#using_rules').val(data.mms_text);
    $('.spanname').text(data.goods_name);
    //$('#goods_image').attr('src', data.goods_image);
	$('#mms_title, #using_rules, #goods_memo').trigger('keyup');
    //不限库存
    if(data.storage_type == '0'){
		$("#select_goods_limit").val("-1");
		//$('#buy_limit_note').html("注：该商品库存不限");
		//$('.goods_total_num').show();
		$("[name='goods_num_limit']").closest("li").find(".txtTips").hide();
		if($("[name='goods_num_limit']").closest(".switch").hasClass("hover")){
			$("[name='goods_num_limit']").closest(".switch").removeClass("disabled");
			$("[name='goods_num_limit']").closest(".switch").click();
		}
    }
    //限制库存
    else{
		if(!$("[name='goods_num_limit']").closest(".switch").hasClass("hover")){
			$("[name='goods_num_limit']").closest(".switch").click();
			$("[name='goods_num_limit']").closest(".switch").addClass("disabled");
		}
		$("#select_goods_limit").val(data.remain_num);
		$("[name='goods_num_limit']").closest("li").find(".txtTips").show().html('<span style="color:#ff0000;">该商品库存为'+data.remain_num+'</span>，数量设置不能多于库存')
    }
	$('#buy_limit_note').show();
	//非商品类营销品默认只能选择自提
	if(data.goods_type != '6'){
        $('#delivery_status1').show();
        $('#delivery_status2').hide();
		$('.delivery_flag1').show();
        $(':checkbox[name="delivery_flag[]"][value="0"]').attr('checked', 'checked');
        $(':checkbox[name="delivery_flag[]"][value="1"]').removeAttr('checked');
    }else{
        $('#delivery_status1').hide();
        $('#delivery_status2').show();
        $(':checkbox[name="delivery_flag[]"]').removeAttr('checked');
    }
    //按日期
    /*if(data.verify_time_type == '0'){
        $('#verify_begin_date').val(data.verify_begin_date ? data.verify_begin_date.substr(0, 8) : '');
        $('#verify_end_date').val(data.verify_end_date ? data.verify_end_date.substr(0, 8) : '');
    }
    else{
        $('#verify_begin_days').val(data.verify_begin_date);
        $('#verify_end_days').val(data.verify_end_date);
    }
    $(':radio[name="verify_time_type"][value="'+data.verify_time_type+'"]').trigger('click');

    $('.goods_info').show();
    $('#step2').show();
    $('#nav_step2').addClass('hover');
	*/
    windowheight();
}




</script>

<!--新品推荐-->
<script id="dataHotrecommend" type="text/html">
{{if initialise}}
<div class="shopMod disabled" id="shopMod_{{id}}" data-edit="{{id}}" data-special="13">
	<div class="shopModBox-13">
		<div class="shopModFlashDiv top">
			<ul class="swiper-wrapper">
			{{each list}}
				<li class="swiper-slide"><img src="{{value.img}}"><div class="{{if value.checkRadius==0}} text {{ else if value.checkRadius==1}} radio {{ else if value.checkRadius==2}} radius {{ else }} text {{/if}}"><h2>{{value.title}}</h2><h3>{{value.BannerDescription}}</h3></div></li>
			{{/each}}
			</ul>
			<dl>
				<dd class="hover"></dd>
				<dd></dd>
				<dd></dd>
			</dl>
		</div>
	</div>
</div>
{{/if}}
</script>
<!--新品推荐-->
<script id="editHotrecommend" type="text/html">
{{if initialise}}
<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
    <div class="shopForm fn">
		<ul class="shopFormU">
			<li class="shopFormN">&nbsp;上传音乐：</li>
			<li class="shopFormI">
				<a href="{{if music}}{{music}}{{else}}javascript:void(0){{/if}}" class="btn-up vm btn-upMusic"><label>{{if music}}{{music}}{{else}}&nbsp;{{/if}}</label></a>
				<a href="javascript:void(0)" class="btn-upbtn vm Gbtn-music">上传</a>
				<input type="hidden" name="resp_music" id="resp_music" value="{{music}}">												
				<span class="txtTips">注:音乐格式为mp3，小于等于1M</span>
			</li>
		</ul>
        <ul class="shopFormU">
            <li class="shopFormI noName sortableHotRecommend">
				{{each list as value i }}
					<div class="shopFormBanner fn">
						<i class="del-shopFormBanner del-HotRecommend"></i>
						<div class="img l">
							<i></i>
							<img src="{{value.img}}" />
							<a href="javascript:void(0)" class="change-shopFormBanner">重新上传</a>
						</div>
						<p>标题：<input type="text" class="textbox" maxlength="8" value="{{value.title}}" name="BannerTitle"><span class="maxTips forInput" data-max="8">0/8</span></p>
						<p>简介：<textarea name="BannerDescription" class="textbox" maxlength="50" style="vertical-align: top;width:250px; height:20px;">{{value.BannerDescription}}</textarea><span class="maxTips forArea" data-max="50">0/50</span></p>
						<p>文字形状：<label><input type="radio" value="0" name="checkRadius[{{i}}]" {{if value.checkRadius==0 }} checked="checked" {{/if}}>平铺</label><label><input type="radio" value="1" name="checkRadius[{{i}}]" {{if value.checkRadius==1 }} checked="checked" {{/if}}>圆形</label><label><input type="radio" value="2" name="checkRadius[{{i}}]" {{if value.checkRadius==2 }} checked="checked" {{/if}}>圆角</label></p>
						<p>水平位置：<input type="range" name="checkPositionX" min="0" max="100" value="{{value.checkPositionX}}"></p>
						<p>垂直位置：<input type="range" name="checkPositionY" min="0" max="100" value="{{value.checkPositionY}}"></p>
					</div>
				{{/each}}
                <div class="add-HotRecommend"><i></i>添加一个导航</div>
            </li>
        </ul>
    </div>
</div>
{{/if}}
</script>
<script id="dataIncludeHotrecommend" type="text/html">
	<li class="swiper-slide"><img src="__PUBLIC__/Image/iphone_bg7.png"><div class="text"><h2></h2><h3 style="display:none"></h3></div></li>
</script>
<script id="editIncludeHotrecommend" type="text/html">
	<div class="shopFormBanner fn">
		<i class="del-shopFormBanner del-HotRecommend"></i>
		<div class="img l">
			<i></i>
			<img src="" />
			<a href="javascript:void(0)" class="change-shopFormBanner">重新上传</a>
		</div>
		<p>标题：<input type="text" class="textbox" maxlength="8" value="" name="BannerTitle"><span class="maxTips forInput" data-max="8">0/8</span></p>
		<p>简介：<textarea name="BannerDescription" class="textbox" maxlength="50" style="vertical-align: top;width:250px; height:20px;"></textarea><span class="maxTips forArea" data-max="50">0/50</span></p>
		<p>文字形状：<label><input type="radio" value="0" name="checkRadius[{{list}}]" checked="checked">平铺</label><label><input type="radio" value="1" name="checkRadius[{{list}}]">圆形</label><label><input type="radio" value="2" name="checkRadius[{{list}}]">圆角</label></p>
		<p>水平位置：<input type="range" name="checkPositionX" min="0" max="100" value="0"></p>
		<p>垂直位置：<input type="range" name="checkPositionY" min="0" max="100" value="0"></p>
	</div>
</script>
<script>
var newid = 1;
var isSku = "{$isSku}";
if( isSku ){
    $('.not_skuinfos').hide();
    $('.sku_infos').show();
}else{
    $('.sku_infos').hide();
    $('.not_skuinfos').show();
}
var skudata = {
	cookiename:"",
	cookielist:"",
	length:function(){
		var l = 0;
		for(var i=0;i<skudata.namelist.length;i++){
			if(skudata.namelist[i].list!=""){
				l++;
			}
		}
		if(l==0){l="";}
		return l;
	},
	length2:function(){
		var l = 0;
		for(var i=0;i<skudata.namelist.length;i++){
			if(skudata.namelist[i].list!=""){
				l++;
			}
		}
		return l+2;
	},
	length3:function(){
		var l = 0;
		if(skudata.namelist.length==1){
			l = 0;
		}else if (skudata.namelist.length==2){
			l = skudata.namelist[1].list.length;
		}else if (skudata.namelist.length==3){
			if(skudata.namelist[2].list.length!=0){
				l = skudata.namelist[1].list.length*skudata.namelist[2].list.length;
			}else{
				l = skudata.namelist[1].list.length;
			}
		}
		if(l==0){l="";}
		return l;
	},
	length4:function(){
		var l = 0;
		if (skudata.namelist.length==2){
			l = 0;
		}else if (skudata.namelist.length==3){
			l = skudata.namelist[2].list.length;
		}
		if(l==0){l="";}
		return l;
	},
	namelist: [{$skutype}],
	price : [{$skuDetail}]
};
//大部分修改预览
$(document).ready(function(e){
	skubegin(skudata);
        // var namelist_nums = 0;
        // if(skudata.namelist)
        //     namelist_nums = skudata.namelist.length * 8;  
        //计算已用字数
        // var lenght_nums = namelist_nums + parseInt($('#name').val().length);
        // $("#using_rules").attr("lenght_nums", 100 - lenght_nums);
        // $('#using_rules').attr('class','validate[required,maxSize['+(100 - lenght_nums)+'] textbox');
        // $('#using_rules').attr('maxlength',100-lenght_nums);
        // $('#using_rules_text').attr('data-max', 100-lenght_nums);
        // $('#using_rules_text').html('0/'+(100 - lenght_nums));
	//设置总库存:检测数值
	$("body").on("change keyup click","input[name='allprice'],input[name='allnum'],input[name='allsellprice']",function(e){
		var t = $(this),
			i = t.closest("td").find(".icon-skuOk"),
			v = t.val();
		v=="" ? i.addClass("erro") : i.removeClass("erro");
	});
	//设置总库存:确认
	$("body").on("click",".skuOk-allprice:not('.erro'),.skuOk-allnum:not('.erro'),.skuOk-allsellprice:not('.erro')",function(e){
		var t = $(this),
			h = t.hasClass("skuOk-allprice"),
			i = t.closest("td").find("input"),
			v = i.val();
		if(t.hasClass("skuOk-allprice")){
			h="allprice";
		}else if(t.hasClass("skuOk-allnum")){
			h="allnum";
		}else if(t.hasClass("skuOk-allsellprice")){
			h="allsellprice";
		}else{h= false;}
		if(h=="allprice"){
			var r = /^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/;
			r = r.test(v);
			if(r){
				$("input[name='sellprice']").val(v);
			}else{
				i.addClass("shopFormBannerAn");
				setTimeout(function(){
					i.removeClass('shopFormBannerAn')
				},1000);
			}
		}else if(h=="allnum"){
			var r = /^[\-\+]?\d+$/;
			r = r.test(v);
			if(r){
				$("input[name='sku_storag']").val(v);
                                $('#count_num').val($("input[name='sku_storag']").length*v);
				$("#all").text("已设置的总库存为："+$("input[name='sku_storag']").length*v+"，不填写库存，则商品库存为不限,总共0处为不限");
			}else{
				i.addClass("shopFormBannerAn");
				setTimeout(function(){
					i.removeClass('shopFormBannerAn')
				},1000);
			}
		}else if(h=="allsellprice"){
			var r = /^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/;
			r = r.test(v);
			if(r){
				$("input[name='sellprice']").val(v);
			}else{
				i.addClass("shopFormBannerAn");
				setTimeout(function(){
					i.removeClass('shopFormBannerAn')
				},1000);
			}
		}
		t.addClass("erro");
		i.val("");
	});
	//设置总库存:库存总数预览
	$("body").on("change keyup","input[name='sku_storag']",function(e){
		var l = 0;
		var t = 0;
		for(var i=0;i<$("input[name='sku_storag']").length;i++){
			if($("input[name='sku_storag']:eq("+i+")").val()=="" || $("input[name='sku_storag']:eq("+i+")").val()=="不限" || $("input[name='num']:eq("+i+")").val()=="-1"){
				t++;
			}else{
				l += parseInt($("input[name='sku_storag']:eq("+i+")").val());
			}
		}
                if(t > 0)
                    $('#count_num').val('-1');
                else
                    $('#count_num').val(l);
		$("#all").text("已设置的总库存为："+l+"，不填写库存，则商品库存为不限,总共"+t+"处为不限");
	});
	$("body").on("focus","input[name='sellprice']",function(){
		$("input[name='sellprice']").prev(".formError").remove();
	});
        /*广西石油物流方式处理*/
    /*只有石油的商品才可以选自提，其他商户的商品只能选择物流*/
    <php>if($is_cnpc_gx){</php>
    var goods_no = "{$row['goods_no']}";
    var url = "{:U('CnpcGX/Goods/check_is_self/')}&goods_no=" + goods_no;
    $.get(url, function (data) {
        if (data == "0")
        {
            $('#delivery_flag1_label').hide();
        }else{
            $('#delivery_flag1_label').show();
        }
    });
    <php>}</php>
});
function skubegin(skudata){
	if(skudata.namelist!=""){
		for(var i=0;i<skudata.namelist.length;i++){
			var namelist = skudata.namelist[i];
			namelist["newid"] = newid;
			if(namelist.list!=""){
				for(var j=0;j<namelist.list.length;j++){
					var list = namelist.list[j];
					list["newid"] = newid;
					newid++;
				}
			}
			newid++;
		}
	}
	var html = template("skuList",skudata);
	var html2 = template("skuTable",skudata);
	$(".skuForm").html(html);
	$(".skuTable").html(html2);
	$(".skuList").each(function(index, element) {
		var z = 10-index;
        $(this).css("z-index",z);
    });
	$("input[name='price']").each(function(index, element) {
		var t = $(this),
			id = t.attr("data-id");
		for(var i=0;i<skudata.price.length;i++){
			if(skudata.price[i].id.toString()==id){
				t.val(skudata.price[i].sellprice);
				t.next("span").text(t.val());
				skudata.price[i]["newid"]=t.attr("data-newid");
			}
		}
    });
	$("input[name='sku_storag']").each(function(index, element) {
		var t = $(this),
			id = t.attr("data-id");
		for(var i=0;i<skudata.price.length;i++){
			if(skudata.price[i].id.toString()==id){
				if(Number(skudata.price[i].sku_storag)>=0){
					t.val(skudata.price[i].sku_remain);
					if(skudata.price[i].remain_num>=0){
						t.next("span").text(skudata.price[i].remain_num);
					}else{
						t.next("span").text("不限");
					}
					//t.attr("class","validate[required,custom[number],min[0],max["+skudata.price[i].remain_num+"]]");
				}else if(Number(skudata.price[i].sku_storag)==-1){
					t.val("不限");
					if(skudata.price[i].remain_num>=0){
						t.next("span").text(skudata.price[i].remain_num);
					}else{
						t.next("span").text("不限");
					}
				}
			}
		}
    });
	$("input[name='sellprice']").each(function(index, element) {
		var t = $(this),
			id = t.attr("data-id");
		for(var i=0;i<skudata.price.length;i++){
			if(skudata.price[i].id.toString()==id){
				t.val(skudata.price[i].sellprice);
                                t.next("span").text(skudata.price[i].price);
				skudata.price[i]["newid"]=t.attr("data-newid");
			}
		}
    });
	var l = 0;
	var t = 0;
	for(var i=0;i<$("input[name='sku_storag']").length;i++){
		if($("input[name='sku_storag']:eq("+i+")").val()=="" || $("input[name='sku_storag']:eq("+i+")").val()=="不限" || $("input[name='sku_storag']:eq("+i+")").val()=="-1"){
			t++;
		}else{
			l += parseInt($("input[name='sku_storag']:eq("+i+")").val());
		}
	}
        if(t > 0)
            $('#count_num').val('-1');
        else
            $('#count_num').val(l);
	$("#all").text("已设置的总库存为："+l+"，不填写库存，则商品库存为不限,总共"+t+"处为不限");
}
</script>

<script id="skuList" type="text/html">
{{each namelist}}
<div class="skuList" data-id="{{value.id}}" data-newid="{{value.newid}}">
	<div class="skuListHead fn">
		<i class="icon-skuDel r"><a href="javascript:void(0)" class="a-hide">删除</a></i>
		<div class="searchInput">
			<span data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.name}}</span>
			<i class="icon-skuEdit">
				<a href="javascript:void(0)" class="a-hide">修改</a>
			</i>
			<div class="searchInput-edit dn">
				<div class="input">
				<input type="text" maxlength="6">
					<i class="icon-skuOk erro">
						<a href="javascript:void(0)" class="a-hide">修改</a>
					</i>
				</div>
				<dl class="valLsit">
					{{each cookiename}}
					<dd>{{value}}</dd>
					{{/each}}
					<dd class="nodata dn">"回车"创建临时规格</dd>
				</dl>
				<div class="valLsitclose"></div>
			</div>
		</div>
	</div>
	<div class="skuCon fn">
		<div class="skuRule">
			{{each value.list}}
			<div class="skuRuleItem" data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.val}}<i></i></div>
			{{/each}}
			<div class="skuRuleAdd">
				<div class="input">
					<input type="text">
					<i class="icon-skuOk erro">
						<a href="javascript:void(0)" class="a-hide">修改</a>
					</i>
				</div>
				<dl class="valLsit">
					{{each cookielist}}
					<dd>{{value}}</dd>
					{{/each}}
					<dd class="nodata dn">"回车"创建临时类别</dd>
				</dl>
				<div class="valLsitclose"></div>
				<div class="skuRuleBtn">
					<i></i>添加类型
				</div>
			</div>
		</div>
	</div>
</div>
{{/each}}
<div class="addsku">
	<i></i>
	<span>添加规格</span>
</div>
</script>

<script id="skuRuleItem" type="text/html">
<div class="skuRuleItem">{{name}}<i></i></div>
</script>

<script id="skuTable" type="text/html">
{{if namelist.length >= 1 && namelist[0].list!="" }}
<table cellpadding="0" cellspacing="0" class="sku-table small">
	<tr>
	{{each namelist}}
		{{if value.list!=""}}<th data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.name}}</th>{{/if}}
	{{/each}}
		<th width="130" >售价&nbsp;|&nbsp;原价(元)</th>
		<th width="130" >出售数量&nbsp;|&nbsp;库存</th>
	</tr>
	<tr>
		<td colspan="{{length}}" class="top">批量设置</td>
		<td class="top"><input type="text" name="allprice" placeholder="批量修改" /><i class="icon-skuOk skuOk-allprice erro"><a href="javascript:void(0)" class="a-hide">确定</a></i></td>
		<td class="top"><input type="text" name="allnum" placeholder="请输入数字" /><i class="icon-skuOk skuOk-allnum erro"><a href="javascript:void(0)" class="a-hide">确定</a></i></td>
	</tr>
	
	{{if namelist.length == 1}}
	{{if namelist[0].list!=""}}
		{{each namelist[0].list as value j}}
		<tr>
			<td rowspan="{{length3}}" data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.val}}</td>
			<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
			<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
		</tr>
		{{/each}}
	{{/if}}
	{{/if}}
	
	{{if namelist.length == 2}}
	{{if namelist[0].list!=""}}
		{{each namelist[0].list as value j}}
		<tr>
			<td rowspan="{{length3}}" data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.val}}</td>
			{{if namelist[1].list!=""}}
				{{each namelist[1].list as value1 j}}
					<td rowspan="{{length4}}" data-id="{{value1.id}}" data-newid="{{value1.newid}}">{{value1.val}}</td>
					<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}},{{value1.id}}"  data-newid="{{value.newid}},{{value1.newid}}" /><span>&nbsp;</span></td>
					<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}},{{value1.id}}"  data-newid="{{value.newid}},{{value1.newid}}" /><span>&nbsp;</span></td>
					</tr>
				{{/each}}
			{{else}}
				<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
				<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
				</tr>
			{{/if}}
		{{/each}}
	{{else if namelist[1].list!=""}}
		{{each namelist[1].list as value1 j}}
			<td rowspan="{{length4}}" data-id="{{value1.id}}" data-newid="{{value1.newid}}">{{value1.val}}</td>
			<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value1.id}}"  data-newid="{{value1.newid}}" /><span>&nbsp;</span></td>
			<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value1.id}}"  data-newid="{{value1.newid}}" /><span>&nbsp;</span></td>
			</tr>
		{{/each}}
	{{/if}}
	{{/if}}
	
	{{if namelist.length == 3}}
	{{if namelist[0].list!=""}}
		{{each namelist[0].list as value j}}
		<tr>
			<td rowspan="{{length3}}" data-id="{{value.id}}" data-newid="{{value.newid}}">{{value.val}}</td>
			{{if namelist[1].list!=""}}
				{{each namelist[1].list as value1 j}}
					<td rowspan="{{length4}}" data-id="{{value1.id}}" data-newid="{{value1.newid}}">{{value1.val}}</td>
					{{if namelist[2].list!=""}}
						{{each namelist[2].list as value2 j}}
							<td data-id="{{value2.id}}" data-newid="{{value2.newid}}">{{value2.val}}</td>
							<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}},{{value1.id}},{{value2.id}}"  data-newid="{{value.newid}},{{value1.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
							<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}},{{value1.id}},{{value2.id}}"  data-newid="{{value.newid}},{{value1.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
							</tr>
						{{/each}}
					{{else}}
						<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}},{{value1.id}}"  data-newid="{{value.newid}},{{value1.newid}}" /><span>&nbsp;</span></td>
						<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}},{{value1.id}}"  data-newid="{{value.newid}},{{value1.newid}}" /><span>&nbsp;</span></td>
						</tr>
					{{/if}}
				{{/each}}
			{{else if namelist[2].list!=""}}
				{{each namelist[2].list as value2 j}}
					<td rowspan="{{length4}}" data-id="{{value2.id}}" data-newid="{{value2.newid}}">{{value2.val}}</td>
					<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}},{{value2.id}}"  data-newid="{{value.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
					<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}},{{value2.id}}"  data-newid="{{value.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
					</tr>
				{{/each}}
			{{else}}
				<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
				<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value.id}}"  data-newid="{{value.newid}}" /><span>&nbsp;</span></td>
				</tr>
			{{/if}}
		{{/each}}
	{{else if namelist[1].list!=""}}
		{{each namelist[1].list as value1 j}}
			<td rowspan="{{length4}}" data-id="{{value1.id}}" data-newid="{{value1.newid}}">{{value1.val}}</td>
			{{if namelist[2].list!=""}}
				{{each namelist[2].list as value2 j}}
					<td data-id="{{value2.id}}" data-newid="{{value2.newid}}">{{value2.val}}</td>
					<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value1.id}},{{value2.id}}"  data-newid="{{value1.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
					<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value1.id}},{{value2.id}}"  data-newid="{{value1.newid}},{{value2.newid}}" /><span>&nbsp;</span></td>
					</tr>
				{{/each}}
			{{else}}
				<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value1.id}}"  data-newid="{{value1.newid}}" /><span>&nbsp;</span></td>
				<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value1.id}}"  data-newid="{{value1.newid}}" /><span>&nbsp;</span></td>
				</tr>
			{{/if}}
		{{/each}}
	{{else if namelist[2].list!=""}}
		{{each namelist[2].list as value2 j}}
			<td data-id="{{value2.id}}" data-newid="{{value2.newid}}">{{value2.val}}</td>
			<td class="tl"><input type="text" name="sellprice" class="validate[required,custom[number],min[0]]" data-id="{{value2.id}}"  data-newid="{{value2.newid}}" /><span>&nbsp;</span></td>
			<td class="tl"><input type="text" name="sku_storag" class="validate[custom[number],min[0],max[99999]]" data-id="{{value2.id}}"  data-newid="{{value2.newid}}" /><span>&nbsp;</span></td>
			</tr>
		{{/each}}
	{{/if}}
	{{/if}}
	<tr>
		<td colspan="{{length2}}" id="all">{{allnum}}</span></td>
	</tr>
</table>
{{/if}}
</script>