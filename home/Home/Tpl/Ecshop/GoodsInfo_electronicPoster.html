<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>操作平台_{:C('SITE_TITLE')}</title>
<meta name="Keywords" content="{:C('SITE_KEYWORDS')}" />
<link href="__PUBLIC__/Css/main.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/layout.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/module.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Css/Wshop.css?v=__VR__" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/Js/validationEngine/css/validationEngine.jquery.css?v=__VR__" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.8.2.min.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/jquery.artDialog.js?skin=default"></script>
<script type="text/javascript" src="__PUBLIC__/Js/artDialog4.1.6/plugins/iframeTools.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/global.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC_LOCAL__/Js/My97DatePicker/WdatePicker.js?v=__VR__"></script>
<js href="__PUBLIC__/Js/validationEngine/languages/jquery.validationEngine-zh_CN.js?v=__VR__" />
<js href="__PUBLIC__/Js/validationEngine/jquery.validationEngine.js?v=__VR__" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery.form.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/ajaxfileupload.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/jquery-ui.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-1.11.2.custom/template.js?v=__VR__"></script>
</head>
<body>
    <div id="wrapper">
        <include file="./Home/Tpl/Public/Public_header.html" />  
        <include file="Shop/nav" navmenuid="Navhot"/>
        
        <div id="container" class="bgfff">
            <div id="main" class="rel">
                <div class="sidenav">
                    <!--开始引入左菜单-->                   
                    <include file="Goods/menu" leftmenuid="splb"/>
                </div>
                <div class="subcon fn">
                    <div class="main-name fn">
                        <h4><a href="javascript:history.go(-1);" class="back"><i></i>商品列表</a> / 介绍模板</h4>
                    </div>
                    <div class="proInfoName big hasqr">
                        <div class="infoName-qr">
                            <i class="icon-qrcode"></i>
                            <div class="infoName-qrimg"><img src="__PUBLIC__/Image/wangcai-qr.png"></div>
                        </div>
                        <div class="infoName-img" style="background-image:url(__PUBLIC__/Image/wt_bg.jpg)"></div>
                        <div class="infoName-text">
                            <p>{$row['name']}</p>
                            <p><span>{$classifyInfo}</span></p>
                            <p><span>{$row.batch_amt}</span></p>
                        </div>
                    </div>
                    <div class="Wcanal-tab mt20">
                        <div class="Wcanal-tab-title fn">
                            <p class=""><a href="{:U('Ecshop/GoodsInfo/introduceModel',array('id'=>$mId))}">图文排版</a></p>
                            <p class="Wcanal-tab-hover"><a href="{:U('Ecshop/GoodsInfo/electronicPoster',array('id'=>$mId))}">电子海报</a></p>
                        </div>
                        <div class="Wcanal-tab-list">
                            
                    <div class="shopBox fn">
                        <div class="shopBoxCon nobottom">
                            <div class="shopBoxCon-top"></div>
                            <div class="shopBoxCon-title" id="shopMod_0" data-edit='0'><span>商品名称</span></div>
                            <div class="cl"></div>
                            <div class="shopBoxView nopadding fn">
                                
                            </div>

                        </div>
                        <div class="shopBoxForm">
                            <!--[if IE]><div class="IEmsgerro">您的浏览器无法使用该模块功能,请使用<span>Chrome谷歌浏览器</span>或切换至<span>极速模式</span>/<span>高速模式</span>进行操作</div><![endif]-->
                            <div class="shopBoxFormCon">
                            <form action="{:U('Ecshop/GoodsInfo/editElectronic')}" method="POST" name="theform" id="theform" enctype="multipart/form-data">
                                <input type="hidden" name="id" value="{$mId}" />
                                <!--页面-->
                                <div class="editshopBoxForm shopBoxForm-0"data-id="shopMod_0">
                                    <div class="shopForm fn">
                                           
                                        <ul class="shopFormU dn" id="wxlink">
                                            <li class="shopFormN">*&nbsp;引导页链接：</li>
                                            <li class="shopFormI">
                                                <input class="textbox" name="fans_collect_url" id="fans_collect_url" type="text" value="" placeholder="请输入带http://的地址" />
                                                <p class="txtTips">当消费者不是您微信公众号粉丝时，将引导消费者打开您设置的“引导关注页”。<a href="http://www.wangcaio2o.com/index.php?g=Home&m=Help&a=helpArt&news_id=1333&leftId=zxwt&class_name=%E6%9C%80%E6%96%B0%E9%97%AE%E9%A2%98&type=1" target="_blank">如何设置？</a></p>
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">&nbsp;商品简介：</li>
                                            <li class="shopFormI">
                                                <textarea name="goods_memo" id="goods_memo" class="textbox" maxlength="200">{$row['memo']}</textarea><span class="maxTips forArea" data-max="200">0/200</span>                                               
                                            </li>
                                        </ul>
                                        <ul class="shopFormU">
                                            <li class="shopFormN">&nbsp;分享图片：</li>
                                            <li class="shopFormI">
                                                <a href="javascript:void(0)" class="btn-up btn-upIcon vm" id="share_pic_btn">选择图片</a>
                                                <input type="hidden" name="share_pic" class="share_pic_val" id="share_pic" value="{$row['share_pic']}">
                                                <eq name="row.share_pic" value="">
                                                <img name="img" id="share_pic_show" src="<?php echo get_upload_url($row['share_pic']);?>" width="28" height="28" class="vm ml10 share_pic_show" />
                                                </else>
                                                <img name="img" id="share_pic_show" src="<?php echo get_upload_url($row['share_pic']);?>" width="28" height="28" class="vm ml10 dn share_pic_show" />
                                                </eq>
                                                <img name="img" id="share_pic_show" src="<?php echo get_upload_url($row['share_pic']);?>" width="28" height="28" class="vm ml10 dn share_pic_show" />
                                                <span class="txtTips">建议大小:50*50px;用户通过微信分享时，显示图片</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                </form>
                                <!--页面-->
                            </div>
                        </div>
                    </div>
                        <div class="cl"></div>
                        <div class="fn tl pt10">
                            <a href="javascript:void(0)" class="btn-all ml30 w110" id="sub_button">保存</a>
                            <a href="javascript:void(0)" class="btn-all-del ml20 w110">预览</a>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        <include file="./Home/Tpl/Public/Public_footer.html" /> 
    </div>
    <div class="service"></div>
</body>
</html>
<script>
$(".shopBoxCon-title").click();
shopMod = $(".shopMod").length+1 ;
toArray = "" ;
data="";
checkRadiuslength = $(".sortableHotRecommend").find(".shopFormBanner").length;
data ={
    "module": [
        {
            "initialise": "true",
            "name": "Hotrecommend",
            "music":"",
            "list": [
                {
                    "title": "",
                    "description": "",
                    "img": "__PUBLIC__/Label/Image/Shop/shopModule2-Bg.jpg",
                    "checkRadius": "0",
                    "checktitle": "0",
                    "checkPositionX": "0",
                    "checkPositionY": "0"
                }
            ]
        }
    ]
};
$(document).ready(function(e){
    //可拖动的模块
    if(data!=""){   
        begin(data);
    };
    
    //爆款销售单独
    $("[name^='delivery_flag'][value='0']").change(function(){
        var check = $(this).prop("checked") ? $(this).prop("checked") : false ;
        if(check){
            $(this).closest(".shopFormI").find(".shopFormMore").show();
        }else{
            $(this).closest(".shopFormI").find(".shopFormMore").hide();
        }
    });
        

    $(".switch").click(function(){
        if($(this).hasClass("disabled")){return false;}
        if($(this).hasClass("hover")){
            $(this).removeClass("hover");
            $(this).find("input[type='radio']").val($(this).find(".value1").attr("data-rel"));
            $(this).find("input[type='text']").val("");
        }else{
            $(this).addClass("hover");
            $(this).find("input[type='radio']").val($(this).find(".value2").attr("data-rel"));
        };
    })
    $(".switch input").click(function(){
        event.stopPropagation();
    })
    $("#music").change(function(){
        $(this).prev("a").find("label").text($(this).val());
    })

    //提交表单
    $('#sub_button').click(function(){
        $(".shopBoxCon-title").click();   
        if($("#theform").validationEngine('validate')){
                //判断其他校验
                var returndata = updataJson();  
                if(returndata[0]==""){
                        alert("出错了，提交数据为空！");   
                }
                var datastr=returndata[0];
                $("#theform").ajaxSubmit({
                    beforeSubmit:function(){
                        dialog = art.dialog({title:false,content:"<div class='msg-all-succeed'>正在提交...</div>",padding:0});
                    },
                    success:function(data){
                     if(data.status == '1'){
                        alert("保存成功");  
                        all_art_close();
                        $('#div_content').hide();
                      }else{
                           dialog.time(5).content("<div class='msg-all-error'>"+data.info+"</div>");
                      }
                },
                    dataType:'json'
                });
            return false;
        }
    });

    //轮播图片
    $(".shopBoxFormCon").on("click", ".img",function() {
        var opt = {obj:$(this),type:"upBannerImg",width:640,height:1010,callback:'EditImg'};
            open_img_uploader(opt);
    });

    //分享图片
    $("#share_pic_btn").click(function(){       
        var opt = {obj:$(this),type:"upShare",width:100,height:100,callback:'EditImg'};
            open_img_uploader(opt);
    });
    //音乐
    $(".shopBoxFormCon").on("click", ".Gbtn-music",function(){
        var opt = {
                obj:$(this),
                inputname:'resp_music',
                callback:function(options){
                    $(".btn-upMusic").text(options.savename);
                    $(".btn-upMusic").attr("href",options.src);
                    $("#resp_music").val(options.src);
                }
            };
        open_music_uploader(opt);
    });
    
    //预览
    $(".btn-all-del").click(function(){
        var datastr = updataJson();
        art.dialog.data('datastr', datastr[0]);
        art.dialog.data('title', $("[name='page_title']").val());
        art.dialog.open("{:U('Ecshop/Index/storepreview')}",{
            title:false,
            width:"338px",
            height:"630px",
            ok:function(){
                art.dialog.close();
            }
        });
    })

});
$(window).scroll(function(){
    var serviceTop = $(window).scrollTop();
    window.nowTop = $(window).scrollTop();
    if (serviceTop>190 && window.nowTop > window.preTop){
        if(parseInt($(".shopBox").height())>parseInt($(".shopBoxForm").height())){
            window.preTop = window.nowTop;
            return false;
        }else{
            $(".shopBoxCon").css("margin-top",serviceTop-190);
            window.preTop = window.nowTop;
        }
    }else if (serviceTop>190 && window.nowTop < window.preTop){
            $(".shopBoxCon").css("margin-top",serviceTop-190);
            window.preTop = window.nowTop;
    }else{
        $(".shopBoxCon").css("margin-top",0);
        window.preTop = window.nowTop;
    }
});
</script>
<script type="text/javascript" src="__PUBLIC__/Js/Wshop.js?v=__VR__"></script>
<script type="text/javascript" src="__PUBLIC__/Label/Js/idangerous.swiper.min.js"></script>

<!--新品推荐-->
<script id="dataHotrecommend" type="text/html">
{{if initialise}}
<div class="shopMod disabled" id="shopMod_{{id}}" data-edit="{{id}}" data-special="13">
    <div class="shopModBox-13">
        <div class="shopModFlashDiv top">
            <ul class="swiper-wrapper">
            {{each list}}
                <li class="swiper-slide"><img src="{{value.img}}"><div class="{{if value.checkRadius==0}} text {{ else if value.checkRadius==1}} radio {{ else if value.checkRadius==2}} radius {{ else }} text {{/if}}"><h2>{{value.title}}</h2><h3>{{value.BannerDescription}}</h3></div></li>
            {{/each}}
            </ul>
            <dl>
                <dd class="hover"></dd>
                <dd></dd>
                <dd></dd>
            </dl>
        </div>
    </div>
</div>
{{/if}}
</script>
<!--新品推荐-->
<script id="editHotrecommend" type="text/html">
{{if initialise}}
<div class="editshopBoxForm shopBoxForm-{{id}} dn" data-id="shopMod_{{id}}">
    <div class="shopForm fn">
        <ul class="shopFormU">
            <li class="shopFormN">&nbsp;上传音乐：</li>
            <li class="shopFormI">
                <a href="{{if music}}{{music}}{{else}}javascript:void(0){{/if}}" class="btn-up vm btn-upMusic"><label>{{if music}}{{music}}{{else}}&nbsp;{{/if}}</label></a>
                <a href="javascript:void(0)" class="btn-upbtn vm Gbtn-music">上传</a>
                <input type="hidden" name="resp_music" id="resp_music" value="{{music}}">                                               
                <span class="txtTips">注:音乐格式为mp3，小于等于1M</span>
            </li>
        </ul>
        <ul class="shopFormU">
            <li class="shopFormI noName sortableHotRecommend">
                {{each list as value i }}
                    <div class="shopFormBanner fn">
                        <i class="del-shopFormBanner del-HotRecommend"></i>
                        <div class="img l">
                            <i></i>
                            <img src="{{value.img}}" />
                            <a href="javascript:void(0)" class="change-shopFormBanner">重新上传</a>
                        </div>
                        <p>标题：<input type="text" class="textbox" maxlength="8" value="{{value.title}}" name="BannerTitle"><span class="maxTips forInput" data-max="8">0/8</span></p>
                        <p>简介：<textarea name="BannerDescription" class="textbox" maxlength="50" style="vertical-align: top;width:250px; height:20px;">{{value.BannerDescription}}</textarea><span class="maxTips forArea" data-max="50">0/50</span></p>
                        <p>文字形状：<label><input type="radio" value="0" name="checkRadius[{{i}}]" {{if value.checkRadius==0 }} checked="checked" {{/if}}>平铺</label><label><input type="radio" value="1" name="checkRadius[{{i}}]" {{if value.checkRadius==1 }} checked="checked" {{/if}}>圆形</label><label><input type="radio" value="2" name="checkRadius[{{i}}]" {{if value.checkRadius==2 }} checked="checked" {{/if}}>圆角</label></p>
                        <p>水平位置：<input type="range" name="checkPositionX" min="0" max="100" value="{{value.checkPositionX}}"></p>
                        <p>垂直位置：<input type="range" name="checkPositionY" min="0" max="100" value="{{value.checkPositionY}}"></p>
                    </div>
                {{/each}}
                <div class="add-HotRecommend"><i></i>添加一个导航</div>
            </li>
        </ul>
    </div>
</div>
{{/if}}
</script>
<script id="dataIncludeHotrecommend" type="text/html">
    <li class="swiper-slide"><img src="__PUBLIC__/Image/iphone_bg7.png"><div class="text"><h2></h2><h3 style="display:none"></h3></div></li>
</script>
<script id="editIncludeHotrecommend" type="text/html">
    <div class="shopFormBanner fn">
        <i class="del-shopFormBanner del-HotRecommend"></i>
        <div class="img l">
            <i></i>
            <img src="" />
            <a href="javascript:void(0)" class="change-shopFormBanner">重新上传</a>
        </div>
        <p>标题：<input type="text" class="textbox" maxlength="8" value="" name="BannerTitle"><span class="maxTips forInput" data-max="8">0/8</span></p>
        <p>简介：<textarea name="BannerDescription" class="textbox" maxlength="50" style="vertical-align: top;width:250px; height:20px;"></textarea><span class="maxTips forArea" data-max="50">0/50</span></p>
        <p>文字形状：<label><input type="radio" value="0" name="checkRadius[{{list}}]" checked="checked">平铺</label><label><input type="radio" value="1" name="checkRadius[{{list}}]">圆形</label><label><input type="radio" value="2" name="checkRadius[{{list}}]">圆角</label></p>
        <p>水平位置：<input type="range" name="checkPositionX" min="0" max="100" value="0"></p>
        <p>垂直位置：<input type="range" name="checkPositionY" min="0" max="100" value="0"></p>
    </div>
</script>